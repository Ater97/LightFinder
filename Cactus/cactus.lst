---------------------------------------------
PIC ASSEMBLER LISTING
Line    Address Opcode  Instruction
---------------------------------------------
0001    0000            TEMP	EQU	0x20
0002    0000            DATO  	EQU 0x21
0003    0000            COUNTY 	EQU 0x22
0004    0000            COUNTX 	EQU 0x23
0005    0000            LIMITY 	EQU 0x24
0006    0000            LIMITX 	EQU 0x25
0007    0000            P1	  	EQU 0x26
0008    0000            P2    	EQU 0x27
0009    0000            COUNTBETA EQU 0x28
0010    0000            LIMITBETA EQU 0x29
0011    0000            
0012    0000            VARPHOTOCELL EQU 0x2A
0013    0000            TMPY    EQU 0x2B
0014    0000            TMPX    EQU 0x2C
0015    0000            TMPBETA EQU 0x2D
0016    0000            waffles	EQU 0x2E
0017    0000            LIMITMAXX   EQU 0x2F
0018    0000            LIMITMAXY   EQU 0x30
0019    0000            LIMITMAXBETA EQU 0x31
0020    0000            
0021    0000            varA    EQU 0x33
0022    0000            varB    EQU 0x34
0023    0000            varC    EQU 0x35
0024    0000            VARDISPLAY  EQU 0x36
0025    0000            cont    EQU 0x37 
0026    0000            ADC     EQU 0x38
0027    0000            CON     EQU 0x39
0028    0000            CON2    EQU 0x3A
0029    0000            CON3    EQU 0x3B
0030    0000            GROUPNUMBER	EQU 0x3C
0031    0000            
0032    0000            CounterC EQU 0x3E
0033    0000            CounterB EQU 0x3F
0034    0000            CounterA EQU 0x40
0035    0000            INICIO
0036    0000            
0037    0000            	ORG		0x00
0038    0000    2801    	GOTO	START
0039    0001            
0040    0001            START
0041    0001            	;1 = in        0  = out
0042    0001            	;BIT SET FILE
0043    0001    1683    	BSF 	STATUS, 5; COLOCAMOS EN S EL BIT 5 DE REG. ESTATUS
0044    0002    0186    	CLRF	TRISB
0045    0003    0188    	CLRF	TRISD   
0046    0004            	                    ;BIT CLEARE FILE
0047    0004    1283    	BCF		STATUS, RP0 ;TODOS LOS PINES DE B SON SALIDAS
0048    0005            
0049    0005    3000    	MOVLW	0x00
0050    0006    0086    	MOVWF 	PORTB  ; SET 0 TO ALL PORTS B
0051    0007    3000    	MOVLW	0x00
0052    0008    0088    	MOVWF 	PORTD  ; SET 0 TO ALL PORTS B
0053    0009    30E6    	MOVLW 	0xE6        ;NUMBER OF MOVES/STOPS IN Y, E6h = 230d
0054    000A    00A4    	MOVWF 	LIMITY 
0055    000B    00B0    	MOVWF	LIMITMAXY
0056    000C    3020    	MOVLW 	0x20        ;NUMBER OF MOVES IN X
0057    000D    00A5    	MOVWF 	LIMITX 
0058    000E    00AF    	MOVWF	LIMITMAXX
0059    000F    3010    	MOVLW	0x10	    ;NUMBER OF STOPS IN X, 10h = 16d
0060    0010    00A9    	MOVWF	LIMITBETA
0061    0011    00B1    	MOVWF	LIMITMAXBETA
0062    0012    20C7    	call 	CLEANY      ;SET COUNTERS TO 0
0063    0013    20CA    	call 	CLEANX
0064    0014    20CD    	call 	CLEANBETA
0065    0015    20D0    	call 	CLEANVARPHOTOCELL
0066    0016            ;------------------------------------------------------------------------------
0067    0016                            ;CONFIGURATION FOR THE PHOTOCELL 
0068    0016    1283    	bcf STATUS,RP0 ;Ir banco 0
0069    0017    1303    	bcf STATUS,RP1
0070    0018    3041    	movlw b'01000001' ;A/D conversion Fosc/8
0071    0019    009F    	movwf ADCON0
0072    001A            	;     	     7     6     5    4    3    2       1 0
0073    001A            	; 1Fh ADCON0 ADCS1 ADCS0 CHS2 CHS1 CHS0 GO/DONE ? ADON
0074    001A    1683    	bsf STATUS,RP0 ;Ir banco 1
0075    001B    1303    	bcf STATUS,RP1
0076    001C    3007    	movlw b'00000111'
0077    001D    0081    	movwf OPTION_REG ;TMR0 preescaler, 1:156
0078    001E            	;                7    6      5    4    3   2   1   0 
0079    001E            	; 81h OPTION_REG RBPU INTEDG T0CS T0SE PSA PS2 PS1 PS0
0080    001E    300E    	movlw b'00001110' ;A/D Port AN0/RA0
0081    001F    009F    	movwf ADCON1
0082    0020            	;            7    6     5 4 3     2     1     0 
0083    0020            	; 9Fh ADCON1 ADFM ADCS2 ? ? PCFG3 PCFG2 PCFG1 PCFG0
0084    0020    1405    	bsf TRISA,0 ;RA0 linea de entrada para el ADC
0085    0021                	;Port A: display output
0086    0021    1085        	bcf	TRISA, 1
0087    0022    1105       	bcf	TRISA, 2
0088    0023    1185        	bcf	TRISA, 3
0089    0024    1205       	bcf	TRISA, 4
0090    0025    1285        	bcf	TRISA, 5
0091    0026    1009        	bcf	TRISE, 0
0092    0027    1089        	bcf	TRISE, 1
0093    0028    0186    	clrf TRISB
0094    0029    1283    	bcf STATUS,RP0 ;Ir banco 0
0095    002A    1303    	bcf STATUS,RP1
0096    002B            ;--------------------------------------------------------------------
0097    002B            ;--------------------------------------------------------------------
0098    002B            						;MAIN
0099    002B            MAIN:
0100    002B    2031        call    SEARCH      ;SEARCH BEST POINT
0101    002C    203C        call    MOVEGREATER ;GO TO BEST POINT
0102    002D            WAIT:   
0103    002D                ;DO STUFF WITH THE BUTTON
0104    002D                ;BTFSS	BUTTON
0105    002D    282D        GOTO    WAIT
0106    002E    2045        call    RESTART      ;RETURN TO ORIGINAL POSITION & CLEAN EVERYTHING
0107    002F    282B        GOTO    MAIN
0108    0030    29F4        GOTO    END
0109    0031            SEARCH:
0110    0031    2097    	call	LOOPX ; MOVE X AND Y
0111    0032            
0112    0032    0828    	MOVF 	COUNTBETA, W
0113    0033    00AD    	MOVWF	TMPBETA
0114    0034            
0115    0034    0AA8    	INCF	COUNTBETA,1
0116    0035    0829    	MOVF	LIMITBETA, W	
0117    0036    0228    	SUBWF	COUNTBETA, w
0118    0037    1D03    	BTFSS	STATUS,Z
0119    0038    2831    	GOTO	SEARCH
0120    0039    20CD    	call	CLEANBETA   ;CLEAN COUNTBETA
0121    003A    2090    	call 	LOOPBETAREVERSE    ;RETURN TO ORIGINAL POSITION
0122    003B    0008        RETURN
0123    003C            
0124    003C            ;------------------------------------------------------------------
0125    003C                                    ;MOVE TO GREATER
0126    003C            MOVEGREATER:
0127    003C    2050    	call	LOOPXMAX ; MOVE X 
0128    003D            
0129    003D    0AA8    	INCF	COUNTBETA,1
0130    003E    0831    	MOVF	LIMITMAXBETA, W	
0131    003F    0228    	SUBWF	COUNTBETA, w
0132    0040    1D03    	BTFSS	STATUS,Z
0133    0041    283C    	GOTO	MOVEGREATER
0134    0042    2058        call	LOOPYMAX ; MOVE Y
0135    0043    20CD        call	CLEANBETA
0136    0044    0008        RETURN
0137    0045            
0138    0045            RESTART:
0139    0045    2049        call    LOOPMAXBETAREVERSE
0140    0046    2060        call 	LOOPYREVERSEMAX
0141    0047    20D0    	call 	CLEANVARPHOTOCELL
0142    0048    0008        RETURN
0143    0049            
0144    0049            LOOPMAXBETAREVERSE:
0145    0049    2068    	call 	LOOPXREVERSEMAX
0146    004A            	
0147    004A    0AA8    	INCF	COUNTBETA,1
0148    004B    0831    	MOVF	LIMITMAXBETA, W	
0149    004C    0228    	SUBWF	COUNTBETA, w
0150    004D    1D03    	BTFSS	STATUS,Z
0151    004E    2849    	GOTO	LOOPMAXBETAREVERSE
0152    004F    0008        RETURN
0153    0050            
0154    0050            LOOPXMAX:
0155    0050    20D3    	call 	EJEX
0156    0051            
0157    0051            	;MOVE ON X
0158    0051    0AA3        INCF    COUNTX,1    
0159    0052    082F    	MOVF  	LIMITMAXX, w
0160    0053    0223    	SUBWF 	COUNTX,w
0161    0054    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT < limitx
0162    0055    2850    	GOTO 	LOOPXMAX	; JUMP IF COUNT !=  limitx
0163    0056            	
0164    0056    20CA    	call 	CLEANX
0165    0057    0008    	RETURN
0166    0058            
0167    0058            LOOPYMAX:
0168    0058    20D8    	call 	EJEY
0169    0059            	;MOVE ON Y
0170    0059    0AA2        INCF    COUNTY,1 ;count++
0171    005A    0830    	MOVF  	LIMITMAXY, w
0172    005B    0222    	SUBWF 	COUNTY,w
0173    005C    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT < limity
0174    005D    2858    	GOTO 	LOOPYMAX	; JUMP IF COUNT !=  limity
0175    005E            	;RESET  countY
0176    005E    20C7    	call 	CLEANY
0177    005F    0008    	return
0178    0060            
0179    0060            
0180    0060            LOOPYREVERSEMAX:
0181    0060    20DD    	call 	REVERSEEJEY
0182    0061    0AA2        INCF    COUNTY,1
0183    0062    0830    	MOVF  	LIMITMAXY, w
0184    0063    0222    	SUBWF 	COUNTY,w
0185    0064    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT <32
0186    0065    2860    	GOTO 	LOOPYREVERSEMAX
0187    0066    20C7    	call 	CLEANY
0188    0067    0008    	RETURN
0189    0068            
0190    0068            LOOPXREVERSEMAX:
0191    0068    20E2    	call 	REVERSEEJEX
0192    0069    0AA3        INCF    COUNTX,1
0193    006A            	
0194    006A    082F    	MOVF  	LIMITMAXX, w
0195    006B    0223    	SUBWF 	COUNTX,w
0196    006C    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT <32
0197    006D    2868    	GOTO 	LOOPXREVERSEMAX
0198    006E    20CA    	call 	CLEANX
0199    006F    0008    	RETURN
0200    0070            
0201    0070            ;-------------------------------------------------------------------
0202    0070            ;                   Photocell comparation
0203    0070            	;result		carry zero (status)
0204    0070            	;positive     1		0
0205    0070            	;zero		  1		1
0206    0070            	;negative     0     0
0207    0070            COMPARE: ;ASIGNAR A TMPCELL EL NUMERO EN LA ESCALA DE LUZ (0-9)
0208    0070    00AE        MOVWF   Waffles
0209    0071    022A        SUBWF   VARPHOTOCELL, W ; W = VARPHOTOVELL - TMPCELL 
0210    0072    1C03        BTFSS   STATUS, C   ;IF VARPHOTOCELL < TMPCELL ; c=0 if negative
0211    0073    207B        call    CHANGEPHOTOCELL   
0212    0074            	;goto 	DimeElGordito 
0213    0074    0008        return
0214    0075            
0215    0075            SETZERPY:
0216    0075    3001    	MOVLW	0x01
0217    0076    2882    	GOTO	SETy
0218    0077            SETZERPX:
0219    0077    3001    	MOVLW	0x01
0220    0078    2888    	GOTO	SETX
0221    0079            SETZERPBETA:
0222    0079    3001    	MOVLW	0x01
0223    007A    288E    	GOTO	SETBETA
0224    007B            
0225    007B            
0226    007B            CHANGEPHOTOCELL:
0227    007B    082E        MOVFW   waffles 	  ;DATO of Photocell
0228    007C    00AA        MOVWF   VARPHOTOCELL  ;PHOTOCELL =  Waffles
0229    007D            
0230    007D                
0231    007D            	;MOVFW   TMPY
0232    007D    3000    	MOVLW	0x00
0233    007E    022B    	SUBWF	TMPY,W			;TMPY - 0 
0234    007F    1903    	BTFSC	STATUS,Z		;IF TMP == 0
0235    0080    2875    	GOTO 	SETZERPY
0236    0081    082B    	MOVFW   TMPY
0237    0082            SETy:
0238    0082    00B0        MOVWF   LIMITMAXY     ;LIMITMAXY = TMPY
0239    0083            
0240    0083                ;MOVFW   TMPX
0241    0083    3000    	MOVLW	0x00
0242    0084    022C    	SUBWF	TMPX,W
0243    0085    1903    	BTFSC	STATUS,Z
0244    0086    2877    	GOTO	SETZERPX
0245    0087    082C    	MOVFW	TMPX
0246    0088            SETX:
0247    0088    00AF        MOVWF   LIMITMAXX     ;LIMITMAXX = TMPX
0248    0089            
0249    0089               ; MOVFW   TMPBETA
0250    0089    3000       	MOVLW	0x00
0251    008A    022D    	SUBWF	TMPBETA,W
0252    008B    1903    	BTFSC	STATUS,Z
0253    008C    2879    	GOTO	SETZERPBETA
0254    008D    082D    	MOVFW	TMPBETA
0255    008E            SETBETA:
0256    008E    00B1        MOVWF   LIMITMAXBETA  ;LIMITMAXBETA = TMPBETA
0257    008F    0008        return 
0258    0090            
0259    0090            ;---------------------------------------------------------------------
0260    0090            ;                       LOOPS
0261    0090            LOOPBETAREVERSE:
0262    0090    20B6    	call 	LOOPXREVERSE
0263    0091            	
0264    0091    0AA8    	INCF	COUNTBETA,1
0265    0092    0829    	MOVF	LIMITBETA, W	
0266    0093    0228    	SUBWF	COUNTBETA, w
0267    0094    1D03    	BTFSS	STATUS,Z
0268    0095    2890    	GOTO	LOOPBETAREVERSE
0269    0096    0008    	RETURN
0270    0097            
0271    0097            LOOPX: ; LOOP i <= LIMITX
0272    0097    20D3    	call 	EJEX
0273    0098            
0274    0098    0823    	MOVFW 	COUNTX
0275    0099    00AC    	MOVWF	TMPX
0276    009A            
0277    009A            	;MOVE ON X
0278    009A    0AA3        INCF    COUNTX,1
0279    009B    0825    	MOVF  	LIMITX, w
0280    009C    0223    	SUBWF 	COUNTX,w
0281    009D    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT < limitx
0282    009E    2897    	GOTO 	LOOPX	; JUMP IF COUNT !=  limitx
0283    009F    20A2    	call	LOOPY ; MOVE Y
0284    00A0            
0285    00A0    20CA    	call 	CLEANX
0286    00A1    0008    	RETURN
0287    00A2            
0288    00A2            LOOPY: ;LOOP i <= LIMITY
0289    00A2    20D8    	call 	EJEY
0290    00A3            
0291    00A3    0822    	MOVFW 	COUNTY
0292    00A4    00AB    	MOVWF	TMPY
0293    00A5            
0294    00A5            	;INSERT LOGIC COMPARE VALUE OF PHOTOCELL & SAVE IT
0295    00A5                ;maybe add a delay here \o/
0296    00A5    213B        call    GET_PHOTOCELL
0297    00A6            
0298    00A6            	;MOVE ON Y
0299    00A6    0AA2        INCF    COUNTY,1
0300    00A7    0824    	MOVF  	LIMITY, w
0301    00A8    0222    	SUBWF 	COUNTY,w
0302    00A9    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT < limity
0303    00AA    28A2    	GOTO 	LOOPY	; JUMP IF COUNT !=  limity
0304    00AB            	;RESET Y
0305    00AB    20C7    	call 	CLEANY
0306    00AC    20AE    	call 	LOOPYREVERSE
0307    00AD    0008    	return
0308    00AE            
0309    00AE            LOOPYREVERSE:
0310    00AE    20DD    	call 	REVERSEEJEY
0311    00AF    0AA2        INCF    COUNTY,1
0312    00B0    0824    	MOVF  	LIMITY, w
0313    00B1    0222    	SUBWF 	COUNTY,w
0314    00B2    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT <32
0315    00B3    28AE    	GOTO 	LOOPYREVERSE
0316    00B4    20C7    	call 	CLEANY
0317    00B5    0008    	RETURN
0318    00B6            
0319    00B6            LOOPXREVERSE:
0320    00B6    20E2    	call 	REVERSEEJEX
0321    00B7    0AA3        INCF    COUNTX,1
0322    00B8    0825    	MOVF  	LIMITX, w
0323    00B9    0223    	SUBWF 	COUNTX,w
0324    00BA    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT <32
0325    00BB    28B6    	GOTO 	LOOPXREVERSE
0326    00BC    20CA    	call 	CLEANX
0327    00BD    0008    	RETURN
0328    00BE            ;-------------------------------------------------------------------
0329    00BE            ;						DELAYS
0330    00BE            Delay ; = 0.0001 seconds
0331    00BE            			;496 cycles
0332    00BE    30A5    	movlw	0xA5
0333    00BF    00A6    	movwf	p1
0334    00C0            Delay_0
0335    00C0    0BA6    	decfsz	p1, f
0336    00C1    28C0    	goto	Delay_0
0337    00C2            
0338    00C2            			;4 cycles (including call)
0339    00C2    0008    	return
0340    00C3            ;-------------------------------------------------------------------
0341    00C3            ;						UTILITIES
0342    00C3            MOVEVALUE:	
0343    00C3    20BE    	call 	DELAY
0344    00C4    0821    	MOVF	DATO, W  
0345    00C5    0086    	MOVWF	PORTB	
0346    00C6    0008    	RETURN
0347    00C7            CLEANY:
0348    00C7    3000    	MOVLW 	0x00  ;se asigna la literal a w (0x00)
0349    00C8    00A2    	MOVWF 	COUNTY ;muevo w a COUNT 
0350    00C9    0008    	RETURN
0351    00CA            CLEANX:
0352    00CA    3000    	MOVLW 	0x00  ;se asigna la literal a w (0x00)
0353    00CB    00A3    	MOVWF 	COUNTX ;muevo w a COUNT 
0354    00CC    0008    	RETURN
0355    00CD            CLEANBETA:
0356    00CD    3000    	MOVLW 	0x00  ;se asigna la literal a w (0x00)
0357    00CE    00A8    	MOVWF 	COUNTBETA ;muevo w a COUNT 
0358    00CF    0008    	RETURN
0359    00D0            CLEANVARPHOTOCELL:
0360    00D0    3000    	MOVLW	0x00
0361    00D1    00AA    	MOVWF	VARPHOTOCELL
0362    00D2    0008    	RETURN
0363    00D3            EJEX:	
0364    00D3    210B    	call	MV12
0365    00D4    20FB    	call	MV06
0366    00D5    20EF    	call	MV03
0367    00D6    2107    	call	MV09
0368    00D7    0008    	RETURN
0369    00D8            EJEY:	
0370    00D8    2137    	call	MVY12
0371    00D9    2127    	call	MVY6
0372    00DA    211B    	call	MVY3
0373    00DB    2133    	call	MVY9
0374    00DC    0008    	RETURN
0375    00DD            REVERSEEJEY:
0376    00DD            	;call 	DELAY
0377    00DD    2133    	call	MVY9
0378    00DE    211B    	call	MVY3
0379    00DF    2127    	call	MVY6
0380    00E0    2137    	call	MVY12
0381    00E1    0008    	RETURN
0382    00E2            REVERSEEJEX:
0383    00E2    2107    	call  	MV09
0384    00E3    20EF    	call	MV03
0385    00E4    20FB    	call	MV06
0386    00E5    210B    	call	MV12
0387    00E6    0008    	RETURN
0388    00E7            
0389    00E7            MV01:	
0390    00E7    3001    	MOVLW	B'00000001'
0391    00E8    00A1    	MOVWF	DATO
0392    00E9    20C3    	call	MOVEVALUE
0393    00EA    0008    	RETURN
0394    00EB            
0395    00EB            MV02:
0396    00EB    3002    	MOVLW	B'00000010'
0397    00EC    00A1    	MOVWF	DATO
0398    00ED    20C3    	call	MOVEVALUE
0399    00EE    0008    	RETURN
0400    00EF            MV03:	
0401    00EF    3003    	MOVLW	B'00000011'
0402    00F0    00A1    	MOVWF	DATO
0403    00F1    20C3    	call	MOVEVALUE
0404    00F2    0008    	RETURN
0405    00F3            
0406    00F3            MV04:
0407    00F3    3004    	MOVLW	B'00000100'
0408    00F4    00A1    	MOVWF	DATO
0409    00F5    20C3    	call	MOVEVALUE
0410    00F6    0008    	RETURN
0411    00F7            MV05:
0412    00F7    3005    	MOVLW	B'00000101'
0413    00F8    00A1    	MOVWF	DATO
0414    00F9    20C3    	call	MOVEVALUE
0415    00FA    0008    	RETURN
0416    00FB            MV06:
0417    00FB    3006    	MOVLW	B'00000110'
0418    00FC    00A1    	MOVWF	DATO
0419    00FD    20C3    	call	MOVEVALUE
0420    00FE    0008    	RETURN
0421    00FF            MV07:
0422    00FF    3007    	MOVLW	B'00000111'
0423    0100    00A1    	MOVWF	DATO
0424    0101    20C3    	call	MOVEVALUE
0425    0102    0008    	RETURN
0426    0103            MV08:
0427    0103    3008    	MOVLW	B'00001000'
0428    0104    00A1    	MOVWF	DATO
0429    0105    20C3    	call	MOVEVALUE
0430    0106    0008    	RETURN
0431    0107            MV09:
0432    0107    3009    	MOVLW	B'00001001'
0433    0108    00A1    	MOVWF	DATO
0434    0109    20C3    	call	MOVEVALUE
0435    010A    0008    	RETURN
0436    010B            MV12:
0437    010B    300C    	MOVLW	B'00001100'
0438    010C    00A1    	MOVWF	DATO
0439    010D    20C3    	call	MOVEVALUE
0440    010E    0008    	RETURN
0441    010F            MVy0:
0442    010F    3000    	MOVLW	B'00000000'
0443    0110    00A1    	MOVWF	DATO
0444    0111    20C3    	call	MOVEVALUE
0445    0112    0008    	RETURN
0446    0113            MVY1:
0447    0113    3010    	MOVLW	B'00010000'
0448    0114    00A1    	MOVWF	DATO
0449    0115    20C3    	call	MOVEVALUE
0450    0116    0008    	RETURN
0451    0117            MVY2:
0452    0117    3020    	MOVLW	B'00100000'
0453    0118    00A1    	MOVWF	DATO
0454    0119    20C3    	call	MOVEVALUE
0455    011A    0008    	RETURN
0456    011B            MVY3:
0457    011B    3030    	MOVLW	B'00110000'
0458    011C    00A1    	MOVWF	DATO
0459    011D    20C3    	call	MOVEVALUE
0460    011E    0008    	RETURN
0461    011F            MVY4:
0462    011F    3040    	MOVLW	B'01000000'
0463    0120    00A1    	MOVWF	DATO
0464    0121    20C3    	call	MOVEVALUE
0465    0122    0008    	RETURN
0466    0123            MVY5:
0467    0123    3050    	MOVLW	B'01010000'
0468    0124    00A1    	MOVWF	DATO
0469    0125    20C3    	call	MOVEVALUE
0470    0126    0008    	RETURN
0471    0127            MVY6:
0472    0127    3060    	MOVLW	B'01100000'
0473    0128    00A1    	MOVWF	DATO
0474    0129    20C3    	call	MOVEVALUE
0475    012A    0008    	RETURN
0476    012B            MVY7:
0477    012B    3070    	MOVLW	B'01110000'
0478    012C    00A1    	MOVWF	DATO
0479    012D    20C3    	call	MOVEVALUE
0480    012E    0008    	RETURN
0481    012F            MVY8:
0482    012F    3080    	MOVLW	B'10000000'
0483    0130    00A1    	MOVWF	DATO
0484    0131    20C3    	call	MOVEVALUE
0485    0132    0008    	RETURN
0486    0133            MVY9:
0487    0133    3090    	MOVLW	B'10010000'
0488    0134    00A1    	MOVWF	DATO
0489    0135    20C3    	call	MOVEVALUE
0490    0136    0008    	RETURN
0491    0137            MVY12:
0492    0137    30C0    	MOVLW	B'11000000'
0493    0138    00A1    	MOVWF	DATO
0494    0139    20C3    	call	MOVEVALUE
0495    013A    0008    	RETURN
0496    013B            ;-----------------------------------------------------------------
0497    013B            ;							PHOTOCELL
0498    013B            GET_PHOTOCELL:
0499    013B            _bucle:
0500    013B            	;btfss INTCON,T0IF
0501    013B            	;goto _bucle ;Esperar que el timer0 desborde
0502    013B            	; SE DEBE DE COLOCAR UN DELAY PARA QUE ESPERE LA CONVERSION
0503    013B    1503    	BSF  STATUS,Z
0504    013C    2193    	CALL _PRESPERA
0505    013D    110B    	bcf INTCON,T0IF ;Limpiar el indicador de desborde
0506    013E    151F    	bsf ADCON0,GO ;Comenzar conversion A/D
0507    013F            _espera:
0508    013F    191F    	btfsc ADCON0,GO ;ADCON0 es 0? (la conversion esta completa?)
0509    0140    293F    	goto _espera ;No, ir _espera
0510    0141    081E    	movf ADRESH,W ;Si, W=ADRESH
0511    0142            	; 1Eh ADRESH A/D Result Register High Byte
0512    0142            	; 9Eh ADRESL A/D Result Register Low Byte 
0513    0142    00B8    	movwf ADC ;ADC=W
0514    0143    0838    	movfw ADC ;W = ADC
0515    0144    2947        	goto  V1
0516    0145            returnExec:
0517    0145    2070    	call 	COMPARE
0518    0146    0008    	return
0519    0147            
0520    0147            V1:
0521    0147    30D2        movlw D'210'
0522    0148    0238        subwf ADC, W
0523    0149    1C03        btfss STATUS, C
0524    014A    294F        goto V2
0525    014B    3000        movlw 0x0
0526    014C    00AE        movwf waffles
0527    014D    21A4        call case0
0528    014E    2945        goto returnExec
0529    014F            
0530    014F            V2:
0531    014F    30C2        movlw D'194'
0532    0150    0238        subwf ADC, W
0533    0151    1C03        btfss STATUS, C
0534    0152    2957        goto V3
0535    0153    3001        movlw 0x1
0536    0154    00AE        movwf waffles
0537    0155    21AC        call case1
0538    0156    2945        goto returnExec
0539    0157            
0540    0157            V3:
0541    0157    30AE        movlw D'174'
0542    0158    0238        subwf ADC, W
0543    0159    1C03        btfss STATUS, C
0544    015A    295F        goto V4
0545    015B    3002        movlw 0x2
0546    015C    00AE        movwf waffles
0547    015D    21B4        call case2
0548    015E    2945        goto returnExec
0549    015F            
0550    015F            V4:
0551    015F    309E        movlw D'158'
0552    0160    0238        subwf ADC, W
0553    0161    1C03        btfss STATUS, C
0554    0162    2967        goto V5
0555    0163    3003        movlw 0x3
0556    0164    00AE        movwf waffles
0557    0165    21BC        call case3
0558    0166    2945        goto returnExec
0559    0167            
0560    0167            V5:
0561    0167    308A        movlw D'138'
0562    0168    0238        subwf ADC, W
0563    0169    1C03        btfss STATUS, C
0564    016A    296F        goto V6
0565    016B    3004        movlw 0x4
0566    016C    00AE        movwf waffles
0567    016D    21C4        call case4
0568    016E    2945        goto returnExec
0569    016F            
0570    016F            V6:
0571    016F    3075        movlw D'117'
0572    0170    0238        subwf ADC, W
0573    0171    1C03        btfss STATUS, C
0574    0172    2977        goto V7
0575    0173    3005        movlw 0x5
0576    0174    00AE        movwf waffles
0577    0175    21CC        call case5
0578    0176    2945        goto returnExec
0579    0177            
0580    0177            V7:
0581    0177    3052        movlw D'82'
0582    0178    0238        subwf ADC, W
0583    0179    1C03        btfss STATUS, C
0584    017A    297F        goto V8
0585    017B    3006        movlw 0x6
0586    017C    00AE        movwf waffles
0587    017D    21D4        call case6
0588    017E    2945        goto returnExec
0589    017F            
0590    017F            V8:
0591    017F    3033        movlw D'51'
0592    0180    0238        subwf ADC, W
0593    0181    1C03        btfss STATUS, C
0594    0182    2987        goto V9
0595    0183    3007        movlw 0x7
0596    0184    00AE        movwf waffles
0597    0185    21DC        call case7
0598    0186    2945        goto returnExec
0599    0187            
0600    0187            V9:
0601    0187    301C        movlw D'28'
0602    0188    0238        subwf ADC, W
0603    0189    1C03        btfss STATUS, C
0604    018A    298F        goto V10
0605    018B    3008        movlw 0x8
0606    018C    00AE        movwf waffles
0607    018D    21E4        call case8
0608    018E    2945        goto returnExec
0609    018F            
0610    018F            V10:
0611    018F                ; movlw D'0'
0612    018F                ; subwf ADC, W
0613    018F                ; btfss STATUS, N
0614    018F                ; goto V10<--
0615    018F                ;btfsc STATUS, C
0616    018F    3009        movlw 0x9
0617    0190    00AE        movwf waffles
0618    0191    21EC        call case9
0619    0192    2945        goto returnExec
0620    0193            
0621    0193            _PRESPERA:
0622    0193    30FF    	MOVLW 0XFF
0623    0194    00C0    	MOVWF CounterA
0624    0195    00BF    	MOVWF COUNTERb
0625    0196    00BE    	MOVWF COUNTERc	
0626    0197    2199    	CALL ESPE
0627    0198    0008    	RETURN	
0628    0199            	
0629    0199            ESPE:
0630    0199    0BC0    	DECFSZ	CounterA,0X01
0631    019A    2999    	GOTO	ESPE
0632    019B    219D    	CALL	ESPE2
0633    019C    0008    	RETURN
0634    019D            ESPE2:
0635    019D    0BBF    	DECFSZ	COUNTERb,0X01
0636    019E    299D    	GOTO	ESPE2
0637    019F    21A1    	CALL	ESPE3
0638    01A0    0008    	RETURN
0639    01A1            ESPE3:
0640    01A1    0BBE    	DECFSZ	COUNTERc,0X01
0641    01A2    29A1    	GOTO	ESPE3
0642    01A3    0008    	RETURN	
0643    01A4            
0644    01A4            case0
0645    01A4    1485        bsf PORTA, 1
0646    01A5    1505        bsf PORTA, 2
0647    01A6    1585        bsf PORTA, 3
0648    01A7    1605        bsf PORTA, 4
0649    01A8    1685        bsf PORTA, 5
0650    01A9    1409        bsf PORTE, 0
0651    01AA    1089        bcf PORTE, 1
0652    01AB    0008        return 
0653    01AC            case1
0654    01AC                ;movlw 0x0
0655    01AC    1085        bcf PORTA, 1
0656    01AD    1205        bcf PORTA, 4
0657    01AE    1285        bcf PORTA, 5
0658    01AF    1009        bcf PORTE, 0
0659    01B0    1089        bcf PORTE, 1
0660    01B1                ;movlw 0x1
0661    01B1    1505        bsf PORTA, 2
0662    01B2    1585        bsf PORTA, 3
0663    01B3    0008        return
0664    01B4            case2
0665    01B4                ;movlw 0x1
0666    01B4    1485        bsf PORTA, 1
0667    01B5    1505        bsf PORTA, 2
0668    01B6    1605        bsf PORTA, 4
0669    01B7    1685        bsf PORTA, 5
0670    01B8    1489        bsf PORTE, 1
0671    01B9                ;movlw 0x0
0672    01B9    1185        bcf PORTA, 3
0673    01BA    1009        bcf PORTE, 0
0674    01BB    0008        return
0675    01BC            case3
0676    01BC                ;movlw 0x1
0677    01BC    1485        bsf PORTA, 1
0678    01BD    1505        bsf PORTA, 2
0679    01BE    1585        bsf PORTA, 3
0680    01BF    1605        bsf PORTA, 4
0681    01C0    1489        bsf PORTE, 1
0682    01C1                ;movlw 0x0
0683    01C1    1009        bcf PORTE, 0
0684    01C2    1285        bcf PORTA, 5
0685    01C3    0008        return
0686    01C4            case4
0687    01C4                ;movlw 0x1
0688    01C4    1505        bsf PORTA, 2
0689    01C5    1585        bsf PORTA, 3
0690    01C6    1409        bsf PORTE, 0
0691    01C7    1489        bsf PORTE, 1
0692    01C8                ;movlw 0x0
0693    01C8    1085        bcf PORTA, 1
0694    01C9    1205        bcf PORTA, 4
0695    01CA    1285        bcf PORTA, 5
0696    01CB    0008        return
0697    01CC            case5
0698    01CC                ;movlw 0x1
0699    01CC    1585        bsf PORTA, 3
0700    01CD    1605        bsf PORTA, 4
0701    01CE    1409        bsf PORTE, 0
0702    01CF    1489        bsf PORTE, 1
0703    01D0    1485        bsf PORTA, 1
0704    01D1                ;movlw 0x0
0705    01D1    1285        bcf PORTA, 5
0706    01D2    1105        bcf PORTA, 2
0707    01D3    0008        return
0708    01D4            case6
0709    01D4                ;movlw 0x1
0710    01D4    1585        bsf PORTA, 3
0711    01D5    1605        bsf PORTA, 4
0712    01D6    1685        bsf PORTA, 5
0713    01D7    1409        bsf PORTE, 0
0714    01D8    1489        bsf PORTE, 1
0715    01D9    1485        bsf PORTA, 1
0716    01DA                ;movlw 0x0
0717    01DA    1105        bcf PORTA, 2
0718    01DB    0008        return
0719    01DC            case7
0720    01DC                ;movlw 0x1
0721    01DC    1485        bsf PORTA, 1
0722    01DD    1505        bsf PORTA, 2
0723    01DE    1585        bsf PORTA, 3
0724    01DF                ;movlw 0x0
0725    01DF    1205        bcf PORTA, 4
0726    01E0    1285        bcf PORTA, 5
0727    01E1    1009        bcf PORTE, 0
0728    01E2    1089        bcf PORTE, 1
0729    01E3    0008        return
0730    01E4            case8
0731    01E4                ;movlw 0x1
0732    01E4    1485        bsf PORTA, 1
0733    01E5    1505        bsf PORTA, 2
0734    01E6    1585        bsf PORTA, 3
0735    01E7    1605        bsf PORTA, 4
0736    01E8    1685        bsf PORTA, 5
0737    01E9    1409        bsf PORTE, 0
0738    01EA    1489        bsf PORTE, 1
0739    01EB    0008        return
0740    01EC            case9
0741    01EC                ;movlw 0x1
0742    01EC    1485        bsf PORTA, 1
0743    01ED    1505        bsf PORTA, 2
0744    01EE    1585        bsf PORTA, 3
0745    01EF    1605        bsf PORTA, 4
0746    01F0    1409        bsf PORTE, 0
0747    01F1    1489        bsf PORTE, 1
0748    01F2                ;movlw 0x0
0749    01F2    1285        bcf PORTA, 5
0750    01F3    0008        return
0751    01F4            
0752    01F4            END
---------------------------------------------
Number of errors = 0
