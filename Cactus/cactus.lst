---------------------------------------------
PIC ASSEMBLER LISTING
Line    Address Opcode  Instruction
---------------------------------------------
0001    0000            zTEMP	EQU	0x20
0002    0000            DATO  	EQU 0x21
0003    0000            COUNTY 	EQU 0x22
0004    0000            COUNTX 	EQU 0x23
0005    0000            LIMITY 	EQU 0x24
0006    0000            LIMITX 	EQU 0x25
0007    0000            P1	  	EQU 0x26
0008    0000            P2    	EQU 0x27
0009    0000            COUNTBETA EQU 0x28
0010    0000            LIMITBETA EQU 0x29
0011    0000            
0012    0000            VARPHOTOCELL EQU 0x2A
0013    0000            TMPY    EQU 0x2B
0014    0000            TMPX    EQU 0x2C
0015    0000            TMPBETA EQU 0x2D
0016    0000            waffles	EQU 0x2E
0017    0000            LIMITMAXX   EQU 0x2F
0018    0000            LIMITMAXY   EQU 0x30
0019    0000            LIMITMAXBETA EQU 0x31
0020    0000            
0021    0000            varA    EQU 0x33
0022    0000            varB    EQU 0x34
0023    0000            varC    EQU 0x35
0024    0000            VARDISPLAY  EQU 0x36
0025    0000            cont    EQU 0x37 
0026    0000            ADC     EQU 0x38
0027    0000            CON     EQU 0x39
0028    0000            CON2    EQU 0x3A
0029    0000            CON3    EQU 0x3B
0030    0000            GROUPNUMBER	EQU 0x3C
0031    0000            
0032    0000            CounterC EQU 0x3E
0033    0000            CounterB EQU 0x3F
0034    0000            CounterA EQU 0x40
0035    0000            ;-----------------------------------------
0036    0000            ;DATO 	EQU 0X41
0037    0000            CONR	EQU 0X42
0038    0000            CONE	EQU 0X43
0039    0000            MAYG	EQU 0X44 ; grupo mayor
0040    0000            MAYV	EQU 0X45 ; valor grupo mayor
0041    0000            MENG	EQU 0X46 ; grupo menor
0042    0000            MENV	EQU 0X47 ; valor grupo menor
0043    0000            ;**********valores de backup
0044    0000            MAYBG	EQU 0X48 ; grupo mayor backup
0045    0000            MAYBV	EQU 0X49 ; valor grupo mayor backup
0046    0000            MENBG	EQU 0X4A ; grupo menor backup
0047    0000            MENBV	EQU 0X4B ; valor grupo menor backup
0048    0000            ;****************************
0049    0000            d1	EQU 0X4C
0050    0000            d2	EQU 0X4D
0051    0000            d3	EQU 0X4E
0052    0000            COUNTMENU EQU 0X50
0053    0000            LIMITMENU EQU 0X51
0054    0000            
0055    0000            
0056    0000            INICIO
0057    0000            
0058    0000            	ORG		0x00
0059    0000    2801    	GOTO	START
0060    0001            
0061    0001            START
0062    0001            	;1 = in        0  = out
0063    0001            	;BIT SET FILE
0064    0001    1683    	BSF 	STATUS, 5; COLOCAMOS EN S EL BIT 5 DE REG. ESTATUS
0065    0002    0186    	CLRF	TRISB
0066    0003    0188    	CLRF	TRISD   
0067    0004    1788    	bsf	TRISD, 7
0068    0005    1708    	bsf	TRISD, 6
0069    0006    1488    	bsf	TRISD, 1
0070    0007                                ;BIT CLEARE FILE
0071    0007    1283    	BCF		STATUS, RP0 ;TODOS LOS PINES DE B SON SALIDAS
0072    0008            
0073    0008    3000    	MOVLW	0x00
0074    0009    0086    	MOVWF 	PORTB  ; SET 0 TO ALL PORTS B
0075    000A    3000    	MOVLW	0x00
0076    000B    0088    	MOVWF 	PORTD  ; SET 0 TO ALL PORTS B
0077    000C    30E6    	MOVLW 	0xE6        ;NUMBER OF MOVES/STOPS IN Y, E6h = 230d
0078    000D    00A4    	MOVWF 	LIMITY 
0079    000E    00B0    	MOVWF	LIMITMAXY
0080    000F    3020    	MOVLW 	0x20        ;NUMBER OF MOVES IN X
0081    0010    00A5    	MOVWF 	LIMITX 
0082    0011    00AF    	MOVWF	LIMITMAXX
0083    0012    3008    	MOVLW	0x08	    ;NUMBER OF STOPS IN X, 10h = 16d 360grads
0084    0013    00A9    	MOVWF	LIMITBETA
0085    0014    00B1    	MOVWF	LIMITMAXBETA
0086    0015    3006    	MOVLW	0x06			
0087    0016    00BC    	MOVWF	GROUPNUMBER
0088    0017    3004    	MOVLW   0X04
0089    0018    00D1    	MOVWF 	LIMITMENU
0090    0019    3007    	MOVLW   0x07
0091    001A    00AA    	MOVWF   varphotocell
0092    001B    214C    	call 	CLEANY      ;SET COUNTERS TO 0
0093    001C    214F    	call 	CLEANX
0094    001D    2152    	call 	CLEANBETA
0095    001E            	;call 	CLEANVARPHOTOCELL
0096    001E            
0097    001E    1683    	BSF	STATUS, 5 
0098    001F            	;BSF	TRISB, 0 ; envï¿½a datos
0099    001F    1708    	BSF	TRISD,6 ;************************
0100    0020            	;BCF	TRISB, 1
0101    0020            	;BCF	TRISB, 2
0102    0020            	;BCF	TRISB, 3
0103    0020            	;BCF	TRISB, 4
0104    0020    1207    	BCF	TRISC, 4 ;************************
0105    0021    1287    	BCF	TRISC, 5 ;************************
0106    0022    1307    	BCF	TRISC, 6 ;************************
0107    0023    1387    	BCF	TRISC, 7 ;************************
0108    0024            
0109    0024            	;BSF	TRISC, 0 ; BIT 0 recibir
0110    0024            	;BSF	TRISC, 1 ; BIT 1 recibir
0111    0024            	;BSF	TRISC, 2 ; BIT 2 recibir
0112    0024            	;BSF	TRISC, 3 ; BIT 3 recibir
0113    0024    1007    	bcf PORTC, 0
0114    0025    1087    	bcf PORTC, 1
0115    0026    1107    	bcf PORTC, 2
0116    0027    1187    	bcf PORTC, 3
0117    0028            	
0118    0028    1408    	BSF	TRISD, 0 ; identifica que tiene que recibir datos
0119    0029    3001    	MOVLW   B'00000001'
0120    002A    00C3    	MOVWF	CONE
0121    002B    00C2    	MOVWF	CONR
0122    002C            
0123    002C    083C    	MOVFW   GROUPNUMBER	
0124    002D    00C4    	MOVWF	MAYG
0125    002E    082A    	MOVFW	VARPHOTOCELL
0126    002F    00C5    	MOVWF	MAYV
0127    0030    083C    	MOVFW   GROUPNUMBER	
0128    0031    00C6    	MOVWF	MENG
0129    0032    082A    	MOVFW	VARPHOTOCELL
0130    0033    00C7    	MOVWF	MENV	
0131    0034            
0132    0034            ;------------------------------------------------------------------------------
0133    0034                            ;CONFIGURATION FOR THE PHOTOCELL 
0134    0034    1283    	bcf STATUS,RP0 ;Ir banco 0
0135    0035    1303    	bcf STATUS,RP1
0136    0036    3041    	movlw b'01000001' ;A/D conversion Fosc/8
0137    0037    009F    	movwf ADCON0
0138    0038            	;     	     7     6     5    4    3    2       1 0
0139    0038            	; 1Fh ADCON0 ADCS1 ADCS0 CHS2 CHS1 CHS0 GO/DONE ? ADON
0140    0038    1683    	bsf STATUS,RP0 ;Ir banco 1
0141    0039    1303    	bcf STATUS,RP1
0142    003A    3007    	movlw b'00000111'
0143    003B    0081    	movwf OPTION_REG ;TMR0 preescaler, 1:156
0144    003C            	;                7    6      5    4    3   2   1   0 
0145    003C            	; 81h OPTION_REG RBPU INTEDG T0CS T0SE PSA PS2 PS1 PS0
0146    003C    300E    	movlw b'00001110' ;A/D Port AN0/RA0
0147    003D    009F    	movwf ADCON1
0148    003E            	;            7    6     5 4 3     2     1     0 
0149    003E            	; 9Fh ADCON1 ADFM ADCS2 ? ? PCFG3 PCFG2 PCFG1 PCFG0
0150    003E    1405    	bsf TRISA,0 ;RA0 linea de entrada para el ADC
0151    003F                	;Port A: display output
0152    003F    1085    	bcf	TRISA, 1
0153    0040    1105    	bcf	TRISA, 2
0154    0041    1185    	bcf	TRISA, 3
0155    0042    1205    	bcf	TRISA, 4
0156    0043    1285    	bcf	TRISA, 5
0157    0044    1009    	bcf	TRISE, 0
0158    0045    1089    	bcf	TRISE, 1
0159    0046    0186    	clrf TRISB
0160    0047    1283    	bcf STATUS,RP0 ;Ir banco 0
0161    0048    1303    	bcf STATUS,RP1
0162    0049            ;--------------------------------------------------------------------
0163    0049            ;--------------------------------------------------------------------
0164    0049            								;MAIN
0165    0049            WAITStart:
0166    0049    1888        BTFSC	PORTD,1
0167    004A    285F        GOTO    MAIN
0168    004B    1909    	BTFSC	PORTE,2
0169    004C    284E    	goto    SHOWBMAX
0170    004D            	;goto	SEND
0171    004D            	;GOTO	SHOWTHINGS
0172    004D            	;CALL 	COMUNICACION
0173    004D    2849    	GOTO    WAITStart
0174    004E            
0175    004E            ShowBMAX:
0176    004E    082A    	MOVFW	VARPHOTOCELL
0177    004F    00B6    	MOVWF	VARDISPLAY
0178    0050    227C    	call	SHOWVARDISPLAY
0179    0051    1C88    	BTFSS	PORTD,1
0180    0052    284E    	goto    SHOWBMAX
0181    0053    2849    	goto 	WAITStart
0182    0054            
0183    0054            
0184    0054            						
0185    0054            SEND:
0186    0054    082A    	MOVFW	VARPHOTOCELL
0187    0055    00B6    	MOVWF	VARDISPLAY
0188    0056    227C    	call	SHOWVARDISPLAY
0189    0057    1F08    	BTFSS 	PORTD, 6
0190    0058    2854    	GOTO 	SEND
0191    0059            	
0192    0059            SEND2:	
0193    0059    083C    	MOVFW	GROUPNUMBER
0194    005A    00B6    	MOVWF	VARDISPLAY
0195    005B    227C    	CALL	SHOWVARDISPLAY
0196    005C    1D09    	BTFSS	PORTE,2
0197    005D    2859    	GOTO 	SEND2
0198    005E    2854    	GOTO	SEND
0199    005F            
0200    005F            MAIN:
0201    005F    20A0        call    SEARCH      ;SEARCH BEST POINT
0202    0060    20AB        call    MOVEGREATER ;GO TO BEST POINT
0203    0061    083C    	MOVFW   GROUPNUMBER	
0204    0062    00C4    	MOVWF	MAYG
0205    0063    082A    	MOVFW	VARPHOTOCELL
0206    0064    00C5    	MOVWF	MAYV
0207    0065    083C    	MOVFW   GROUPNUMBER	
0208    0066    00C6    	MOVWF	MENG
0209    0067    082A    	MOVFW	VARPHOTOCELL
0210    0068    00C7    	MOVWF	MENV	
0211    0069    284E    	GOTO 	SHOWBMAX
0212    006A            
0213    006A            SHOWTHINGS:
0214    006A    0AD0    	INCF	COUNTMENU,1
0215    006B    3001    	MOVLW	1	
0216    006C    0250    	SUBWF	COUNTMENU, w
0217    006D    1903    	BTFSC	STATUS,Z
0218    006E    287C    	GOTO	SHOWMAX
0219    006F            
0220    006F    3002    	MOVLW	2	
0221    0070    0250    	SUBWF	COUNTMENU, w
0222    0071    1903    	BTFSC	STATUS,Z
0223    0072    2881    	GOTO 	SHOWMAXGROUP
0224    0073            
0225    0073    3003    	MOVLW	3	
0226    0074    0250    	SUBWF	COUNTMENU, w
0227    0075    1903    	BTFSC	STATUS,Z
0228    0076    2885    	GOTO	SHOWMINGROUP
0229    0077            
0230    0077    3004    	MOVLW	4	
0231    0078    0250    	SUBWF	COUNTMENU, w
0232    0079    1903    	BTFSC	STATUS,Z
0233    007A    2889    	GOTO 	BUTTONShowGroupNumber
0234    007B            
0235    007B    2849    	GOTO 	WAITStart
0236    007C            
0237    007C            
0238    007C            SHOWMAX:
0239    007C    082A    	MOVFW	VARPHOTOCELL
0240    007D    00B6    	MOVWF	VARDISPLAY
0241    007E    227C    	call	SHOWVARDISPLAY
0242    007F              	;call 	BigDelay 
0243    007F    1D09        BTFSS	PORTE,2
0244    0080    2849        GOTO    WAITStart
0245    0081            
0246    0081            SHOWMAXGROUP:
0247    0081    0844    	MOVFW	MAYG
0248    0082    00B6    	MOVWF	VARDISPLAY
0249    0083    227C    	CALL	SHOWVARDISPLAY
0250    0084            	;call 	BigDelay 
0251    0084            	;BTFSS	PORTE,2
0252    0084    2849    	GOTO 	WAITStart
0253    0085            
0254    0085            
0255    0085            SHOWMINGROUP:
0256    0085    0846    	MOVFW	MENG
0257    0086    00B6    	MOVWF	VARDISPLAY
0258    0087    227C    	CALL	SHOWVARDISPLAY	
0259    0088            	;call 	BigDelay 
0260    0088            	;BTFSS	PORTE,2
0261    0088    2849    	GOTO 	WAITStart
0262    0089            
0263    0089            BUTTONShowGroupNumber:
0264    0089    2158    	CALL 	CLEANBUTTONMENU
0265    008A    083C    	MOVFW	GROUPNUMBER
0266    008B    00B6    	MOVWF	VARDISPLAY
0267    008C    227C    	CALL	SHOWVARDISPLAY
0268    008D            
0269    008D            	;call 	BigDelay 
0270    008D            	;BTFSS	PORTE,2
0271    008D            	;GOTO	BUTTONShowGroupNumber
0272    008D    2849    	GOTO 	WAITStart
0273    008E            ;-------------------
0274    008E            		;cOMUNICACION
0275    008E            	;call 	SHOWComun
0276    008E            COMUNICACION:
0277    008E    213E    	CALL	DELAY_D
0278    008F            	;BTFSC   PORTB, 0 ; si el bit de enviar enta encendido va a enviar datos
0279    008F    1B08    	BTFSC   PORTD, 6;*************************
0280    0090    231D    	CALL	ENVIARDEC
0281    0091    213E    	CALL	DELAY_D
0282    0092    1808    	BTFSC	PORTD, 0
0283    0093    236D    	CALL	RECIBIRDEC
0284    0094            
0285    0094    0008    	RETURN
0286    0095            	;EQUIVALENCIAS DE PUERTOS
0287    0095            		;B1 = C4
0288    0095            		;B2 = C5
0289    0095            		;B3 = C6
0290    0095            		;B4 = C7
0291    0095            		;B0 = D6
0292    0095            ;-----------------------
0293    0095            
0294    0095    20B6        call    RESTART      ;RETURN TO ORIGINAL POSITION & CLEAN EVERYTHING
0295    0096    2849        GOTO    WAITStart
0296    0097    2BDF        GOTO    END
0297    0098            
0298    0098            ;-----------------------------------------------------------------------
0299    0098            ;------------------------------------------------------------------------	
0300    0098            SHOWComun:
0301    0098    1485        bsf PORTA, 1
0302    0099    1105        bcf PORTA, 2
0303    009A    1185        bcf PORTA, 3
0304    009B    1605        bsf PORTA, 4
0305    009C    1685        bsf PORTA, 5
0306    009D    1409        bsf PORTE, 0
0307    009E    1089        bcf PORTE, 1
0308    009F    0008    	return
0309    00A0            
0310    00A0            
0311    00A0            SEARCH:
0312    00A0    2109    	call	LOOPX ; MOVE X AND Y
0313    00A1            
0314    00A1    0828    	MOVF 	COUNTBETA, W
0315    00A2    00AD    	MOVWF	TMPBETA
0316    00A3            
0317    00A3    0AA8    	INCF	COUNTBETA,1
0318    00A4    0829    	MOVF	LIMITBETA, W	
0319    00A5    0228    	SUBWF	COUNTBETA, w
0320    00A6    1D03    	BTFSS	STATUS,Z
0321    00A7    28A0    	GOTO	SEARCH
0322    00A8    2152    	call	CLEANBETA   ;CLEAN COUNTBETA
0323    00A9    2101    	call 	LOOPBETAREVERSE    ;RETURN TO ORIGINAL POSITION
0324    00AA    0008        RETURN
0325    00AB            
0326    00AB            ;------------------------------------------------------------------
0327    00AB                                    ;MOVE TO GREATER
0328    00AB            MOVEGREATER:
0329    00AB    20C9    	call	LOOPYMAX ; MOVE Y
0330    00AC    20AE    	call	LOOPXMAXBETA ; MOVE X 
0331    00AD            	;call 	LOOPXMAX
0332    00AD    0008    	return
0333    00AE            LOOPXMAXBETA:
0334    00AE    20C1    	call 	LOOPXMAX
0335    00AF            
0336    00AF    0AA8    	INCF	COUNTBETA,1
0337    00B0    0831    	MOVF	LIMITMAXBETA, W	
0338    00B1    0228    	SUBWF	COUNTBETA, w
0339    00B2    1D03    	BTFSS	STATUS,Z
0340    00B3    28AE    	GOTO	LOOPXMAXBETA
0341    00B4    2152        call	CLEANBETA
0342    00B5    0008        RETURN
0343    00B6            
0344    00B6            RESTART:
0345    00B6    20BA        call    LOOPMAXBETAREVERSE
0346    00B7    20D1        call 	LOOPYREVERSEMAX
0347    00B8    2155    	call 	CLEANVARPHOTOCELL
0348    00B9    0008        RETURN
0349    00BA            
0350    00BA            LOOPMAXBETAREVERSE:
0351    00BA    20D9    	call 	LOOPXREVERSEMAX
0352    00BB            	
0353    00BB    0AA8    	INCF	COUNTBETA,1
0354    00BC    0831    	MOVF	LIMITMAXBETA, W	
0355    00BD    0228    	SUBWF	COUNTBETA, w
0356    00BE    1D03    	BTFSS	STATUS,Z
0357    00BF    28BA    	GOTO	LOOPMAXBETAREVERSE
0358    00C0    0008        RETURN
0359    00C1            
0360    00C1            LOOPXMAX:	
0361    00C1    215B    	call 	EJEX
0362    00C2            	;MOVE ON X
0363    00C2    0AA3        INCF    COUNTX,1
0364    00C3    0825    	MOVF  	LIMITX, w
0365    00C4    0223    	SUBWF 	COUNTX,w
0366    00C5    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT < limitx
0367    00C6    28C1    	GOTO 	LOOPXMAX	; JUMP IF COUNT !=  limitx
0368    00C7    214F    	call 	CLEANX
0369    00C8    0008    	RETURN
0370    00C9            
0371    00C9            LOOPYMAX:
0372    00C9    2160    	call 	EJEY
0373    00CA            	;MOVE ON Y
0374    00CA    0AA2        INCF    COUNTY,1 ;count++
0375    00CB    0830    	MOVF  	LIMITMAXY, w
0376    00CC    0222    	SUBWF 	COUNTY,w
0377    00CD    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT < limity
0378    00CE    28C9    	GOTO 	LOOPYMAX	; JUMP IF COUNT !=  limity
0379    00CF            	;RESET  countY
0380    00CF    214C    	call 	CLEANY
0381    00D0    0008    	return
0382    00D1            
0383    00D1            
0384    00D1            LOOPYREVERSEMAX:
0385    00D1    2165    	call 	REVERSEEJEY
0386    00D2    0AA2        INCF    COUNTY,1
0387    00D3    0830    	MOVF  	LIMITMAXY, w
0388    00D4    0222    	SUBWF 	COUNTY,w
0389    00D5    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT <32
0390    00D6    28D1    	GOTO 	LOOPYREVERSEMAX
0391    00D7    214C    	call 	CLEANY
0392    00D8    0008    	RETURN
0393    00D9            
0394    00D9            LOOPXREVERSEMAX:
0395    00D9    216A    	call 	REVERSEEJEX
0396    00DA    0AA3        INCF    COUNTX,1
0397    00DB            	
0398    00DB    082F    	MOVF  	LIMITMAXX, w
0399    00DC    0223    	SUBWF 	COUNTX,w
0400    00DD    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT <32
0401    00DE    28D9    	GOTO 	LOOPXREVERSEMAX
0402    00DF    214F    	call 	CLEANX
0403    00E0    0008    	RETURN
0404    00E1            
0405    00E1            ;-------------------------------------------------------------------
0406    00E1            ;                   Photocell comparation
0407    00E1            	;result		carry zero (status)
0408    00E1            	;positive     1		0
0409    00E1            	;zero		  1		1
0410    00E1            	;negative     0     0
0411    00E1            COMPARE: ;ASIGNAR A TMPCELL EL NUMERO EN LA ESCALA DE LUZ (0-9)
0412    00E1    00AE        MOVWF   Waffles
0413    00E2    022A        SUBWF   VARPHOTOCELL, W ; W = VARPHOTOCELL - TMPCELL 
0414    00E3    1C03        BTFSS   STATUS, C   ;IF VARPHOTOCELL < TMPCELL ; c=0 if negative
0415    00E4    20EC        call    CHANGEPHOTOCELL   
0416    00E5            	;goto 	DimeElGordito 
0417    00E5    0008        return
0418    00E6            
0419    00E6            SETZERPY:
0420    00E6    3001    	MOVLW	0x01
0421    00E7    28F3    	GOTO	SETy
0422    00E8            SETZERPX:
0423    00E8    3001    	MOVLW	0x01
0424    00E9    28F9    	GOTO	SETX
0425    00EA            SETZERPBETA:
0426    00EA    3001    	MOVLW	0x01
0427    00EB    28FF    	GOTO	SETBETA
0428    00EC            
0429    00EC            
0430    00EC            CHANGEPHOTOCELL:
0431    00EC    082E        MOVFW   waffles 	  ;DATO of Photocell
0432    00ED    00AA        MOVWF   VARPHOTOCELL  ;PHOTOCELL =  Waffles
0433    00EE            
0434    00EE                
0435    00EE            	;MOVFW   TMPY
0436    00EE    3000    	MOVLW	0x00
0437    00EF    022B    	SUBWF	TMPY,W			;TMPY - 0 
0438    00F0    1903    	BTFSC	STATUS,Z		;IF TMP == 0
0439    00F1    28E6    	GOTO 	SETZERPY
0440    00F2    082B    	MOVFW   TMPY
0441    00F3            SETy:
0442    00F3    00B0        MOVWF   LIMITMAXY     ;LIMITMAXY = TMPY
0443    00F4            
0444    00F4                ;MOVFW   TMPX
0445    00F4    3000    	MOVLW	0x00
0446    00F5    022C    	SUBWF	TMPX,W
0447    00F6    1903    	BTFSC	STATUS,Z
0448    00F7    28E8    	GOTO	SETZERPX
0449    00F8    082C    	MOVFW	TMPX
0450    00F9            SETX:
0451    00F9    00AF        MOVWF   LIMITMAXX     ;LIMITMAXX = TMPX
0452    00FA            
0453    00FA               ; MOVFW   TMPBETA
0454    00FA    3000       	MOVLW	0x00
0455    00FB    022D    	SUBWF	TMPBETA,W
0456    00FC    1903    	BTFSC	STATUS,Z
0457    00FD    28EA    	GOTO	SETZERPBETA
0458    00FE    082D    	MOVFW	TMPBETA
0459    00FF            SETBETA:
0460    00FF    00B1        MOVWF   LIMITMAXBETA  ;LIMITMAXBETA = TMPBETA
0461    0100    0008        return 
0462    0101            
0463    0101            ;---------------------------------------------------------------------
0464    0101            ;                       LOOPS
0465    0101            LOOPBETAREVERSE:
0466    0101    2126    	call 	LOOPXREVERSE
0467    0102            	
0468    0102    0AA8    	INCF	COUNTBETA,1
0469    0103    0829    	MOVF	LIMITBETA, W	
0470    0104    0228    	SUBWF	COUNTBETA, w
0471    0105    1D03    	BTFSS	STATUS,Z
0472    0106    2901    	GOTO	LOOPBETAREVERSE
0473    0107    2152    	call	CLEANBETA
0474    0108    0008    	RETURN
0475    0109            
0476    0109            LOOPX: ; LOOP i <= LIMITX
0477    0109    215B    	call 	EJEX
0478    010A            
0479    010A            	;MOVFW 	COUNTX
0480    010A            	;MOVWF	TMPX
0481    010A            
0482    010A            	;MOVE ON X
0483    010A    0AA3        INCF    COUNTX,1
0484    010B    0825    	MOVF  	LIMITX, w
0485    010C    0223    	SUBWF 	COUNTX,w
0486    010D    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT < limitx
0487    010E    2909    	GOTO 	LOOPX	; JUMP IF COUNT !=  limitx
0488    010F    2112    	call	LOOPY ; MOVE Y
0489    0110            
0490    0110    214F    	call 	CLEANX
0491    0111    0008    	RETURN
0492    0112            
0493    0112            LOOPY: ;LOOP i <= LIMITY
0494    0112    2160    	call 	EJEY
0495    0113            
0496    0113    0822    	MOVFW 	COUNTY
0497    0114    00AB    	MOVWF	TMPY
0498    0115            
0499    0115            	;INSERT LOGIC COMPARE VALUE OF PHOTOCELL & SAVE IT
0500    0115                ;maybe add a delay here \o/
0501    0115    21C3        call    GET_PHOTOCELL
0502    0116            
0503    0116            	;MOVE ON Y
0504    0116    0AA2        INCF    COUNTY,1
0505    0117    0824    	MOVF  	LIMITY, w
0506    0118    0222    	SUBWF 	COUNTY,w
0507    0119    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT < limity
0508    011A    2912    	GOTO 	LOOPY	; JUMP IF COUNT !=  limity
0509    011B            	;RESET Y
0510    011B    214C    	call 	CLEANY
0511    011C    211E    	call 	LOOPYREVERSE
0512    011D    0008    	return
0513    011E            
0514    011E            LOOPYREVERSE:
0515    011E    2165    	call 	REVERSEEJEY
0516    011F    0AA2        INCF    COUNTY,1
0517    0120    0824    	MOVF  	LIMITY, w
0518    0121    0222    	SUBWF 	COUNTY,w
0519    0122    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT <32
0520    0123    291E    	GOTO 	LOOPYREVERSE
0521    0124    214C    	call 	CLEANY
0522    0125    0008    	RETURN
0523    0126            
0524    0126            LOOPXREVERSE:
0525    0126    216A    	call 	REVERSEEJEX
0526    0127    0AA3        INCF    COUNTX,1
0527    0128    0825    	MOVF  	LIMITX, w
0528    0129    0223    	SUBWF 	COUNTX,w
0529    012A    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT <32
0530    012B    2926    	GOTO 	LOOPXREVERSE
0531    012C    214F    	call 	CLEANX
0532    012D    0008    	RETURN
0533    012E            ;-------------------------------------------------------------------
0534    012E            ;						DELAYS
0535    012E            Delay ; = 0.0001 seconds
0536    012E            			;496 cycles
0537    012E    30A5    	movlw	0xA5
0538    012F    00A6    	movwf	p1
0539    0130            Delay_0
0540    0130    0BA6    	decfsz	p1, f
0541    0131    2930    	goto	Delay_0
0542    0132            			;4 cycles (including call)
0543    0132    0008    	return
0544    0133            
0545    0133            BigDelay ; = 0.05 sconds
0546    0133            			;249993 cycles
0547    0133    304E    	movlw	0x4E
0548    0134    00A6    	movwf	p1
0549    0135    30C4    	movlw	0xC4
0550    0136    00A7    	movwf	p2
0551    0137            Delay_1
0552    0137    0BA6    	decfsz	p1, f
0553    0138    293A    	goto	$+2
0554    0139    0BA7    	decfsz	p2, f
0555    013A    2937    	goto	Delay_1
0556    013B            
0557    013B            			;3 cycles
0558    013B    293C    	goto	$+1
0559    013C    0000    	nop
0560    013D            			;4 cycles (including call)
0561    013D    0008    	return
0562    013E            
0563    013E            DELAY_D
0564    013E    3087    	movlw	0x87
0565    013F    00CC    	movwf	d1
0566    0140    3014    	movlw	0x14
0567    0141    00CD    	movwf	d2
0568    0142            DELAY_D_0
0569    0142    0BCC    	decfsz	d1, f
0570    0143    2945    	goto	$+2
0571    0144    0BCD    	decfsz	d2, f
0572    0145    2942    	goto	DELAY_D_0
0573    0146            
0574    0146            			;2 cycles
0575    0146    2947    	goto	$+1
0576    0147    0008    	RETURN
0577    0148            ;-------------------------------------------------------------------
0578    0148            ;						UTILITIES
0579    0148            MOVEVALUE:	
0580    0148    212E    	call 	DELAY
0581    0149    0821    	MOVF	DATO, W  
0582    014A    0086    	MOVWF	PORTB	
0583    014B    0008    	RETURN
0584    014C            CLEANY:
0585    014C    3000    	MOVLW 	0x00  ;se asigna la literal a w (0x00)
0586    014D    00A2    	MOVWF 	COUNTY ;muevo w a COUNT 
0587    014E    0008    	RETURN
0588    014F            CLEANX:
0589    014F    3000    	MOVLW 	0x00  ;se asigna la literal a w (0x00)
0590    0150    00A3    	MOVWF 	COUNTX ;muevo w a COUNT 
0591    0151    0008    	RETURN
0592    0152            CLEANBETA:
0593    0152    3000    	MOVLW 	0x00  ;se asigna la literal a w (0x00)
0594    0153    00A8    	MOVWF 	COUNTBETA ;muevo w a COUNT 
0595    0154    0008    	RETURN
0596    0155            CLEANVARPHOTOCELL:
0597    0155    3000    	MOVLW	0x00
0598    0156    00AA    	MOVWF	VARPHOTOCELL
0599    0157    0008    	RETURN
0600    0158            CLEANBUTTONMENU:
0601    0158    3000    	MOVLW	0x00
0602    0159    00D0    	MOVWF COUNTMENU
0603    015A    0008    	RETURN
0604    015B            
0605    015B            EJEX:	
0606    015B    2193    	call	MV12
0607    015C    2183    	call	MV06
0608    015D    2177    	call	MV03
0609    015E    218F    	call	MV09
0610    015F    0008    	RETURN
0611    0160            EJEY:	
0612    0160    21BF    	call	MVY12
0613    0161    21AF    	call	MVY6
0614    0162    21A3    	call	MVY3
0615    0163    21BB    	call	MVY9
0616    0164    0008    	RETURN
0617    0165            REVERSEEJEY:
0618    0165            	;call 	DELAY
0619    0165    21BB    	call	MVY9
0620    0166    21A3    	call	MVY3
0621    0167    21AF    	call	MVY6
0622    0168    21BF    	call	MVY12
0623    0169    0008    	RETURN
0624    016A            REVERSEEJEX:
0625    016A    218F    	call  	MV09
0626    016B    2177    	call	MV03
0627    016C    2183    	call	MV06
0628    016D    2193    	call	MV12
0629    016E    0008    	RETURN
0630    016F            
0631    016F            MV01:	
0632    016F    3001    	MOVLW	B'00000001'
0633    0170    00A1    	MOVWF	DATO
0634    0171    2148    	call	MOVEVALUE
0635    0172    0008    	RETURN
0636    0173            
0637    0173            MV02:
0638    0173    3002    	MOVLW	B'00000010'
0639    0174    00A1    	MOVWF	DATO
0640    0175    2148    	call	MOVEVALUE
0641    0176    0008    	RETURN
0642    0177            MV03:	
0643    0177    3003    	MOVLW	B'00000011'
0644    0178    00A1    	MOVWF	DATO
0645    0179    2148    	call	MOVEVALUE
0646    017A    0008    	RETURN
0647    017B            
0648    017B            MV04:
0649    017B    3004    	MOVLW	B'00000100'
0650    017C    00A1    	MOVWF	DATO
0651    017D    2148    	call	MOVEVALUE
0652    017E    0008    	RETURN
0653    017F            MV05:
0654    017F    3005    	MOVLW	B'00000101'
0655    0180    00A1    	MOVWF	DATO
0656    0181    2148    	call	MOVEVALUE
0657    0182    0008    	RETURN
0658    0183            MV06:
0659    0183    3006    	MOVLW	B'00000110'
0660    0184    00A1    	MOVWF	DATO
0661    0185    2148    	call	MOVEVALUE
0662    0186    0008    	RETURN
0663    0187            MV07:
0664    0187    3007    	MOVLW	B'00000111'
0665    0188    00A1    	MOVWF	DATO
0666    0189    2148    	call	MOVEVALUE
0667    018A    0008    	RETURN
0668    018B            MV08:
0669    018B    3008    	MOVLW	B'00001000'
0670    018C    00A1    	MOVWF	DATO
0671    018D    2148    	call	MOVEVALUE
0672    018E    0008    	RETURN
0673    018F            MV09:
0674    018F    3009    	MOVLW	B'00001001'
0675    0190    00A1    	MOVWF	DATO
0676    0191    2148    	call	MOVEVALUE
0677    0192    0008    	RETURN
0678    0193            MV12:
0679    0193    300C    	MOVLW	B'00001100'
0680    0194    00A1    	MOVWF	DATO
0681    0195    2148    	call	MOVEVALUE
0682    0196    0008    	RETURN
0683    0197            MVy0:
0684    0197    3000    	MOVLW	B'00000000'
0685    0198    00A1    	MOVWF	DATO
0686    0199    2148    	call	MOVEVALUE
0687    019A    0008    	RETURN
0688    019B            MVY1:
0689    019B    3010    	MOVLW	B'00010000'
0690    019C    00A1    	MOVWF	DATO
0691    019D    2148    	call	MOVEVALUE
0692    019E    0008    	RETURN
0693    019F            MVY2:
0694    019F    3020    	MOVLW	B'00100000'
0695    01A0    00A1    	MOVWF	DATO
0696    01A1    2148    	call	MOVEVALUE
0697    01A2    0008    	RETURN
0698    01A3            MVY3:
0699    01A3    3030    	MOVLW	B'00110000'
0700    01A4    00A1    	MOVWF	DATO
0701    01A5    2148    	call	MOVEVALUE
0702    01A6    0008    	RETURN
0703    01A7            MVY4:
0704    01A7    3040    	MOVLW	B'01000000'
0705    01A8    00A1    	MOVWF	DATO
0706    01A9    2148    	call	MOVEVALUE
0707    01AA    0008    	RETURN
0708    01AB            MVY5:
0709    01AB    3050    	MOVLW	B'01010000'
0710    01AC    00A1    	MOVWF	DATO
0711    01AD    2148    	call	MOVEVALUE
0712    01AE    0008    	RETURN
0713    01AF            MVY6:
0714    01AF    3060    	MOVLW	B'01100000'
0715    01B0    00A1    	MOVWF	DATO
0716    01B1    2148    	call	MOVEVALUE
0717    01B2    0008    	RETURN
0718    01B3            MVY7:
0719    01B3    3070    	MOVLW	B'01110000'
0720    01B4    00A1    	MOVWF	DATO
0721    01B5    2148    	call	MOVEVALUE
0722    01B6    0008    	RETURN
0723    01B7            MVY8:
0724    01B7    3080    	MOVLW	B'10000000'
0725    01B8    00A1    	MOVWF	DATO
0726    01B9    2148    	call	MOVEVALUE
0727    01BA    0008    	RETURN
0728    01BB            MVY9:
0729    01BB    3090    	MOVLW	B'10010000'
0730    01BC    00A1    	MOVWF	DATO
0731    01BD    2148    	call	MOVEVALUE
0732    01BE    0008    	RETURN
0733    01BF            MVY12:
0734    01BF    30C0    	MOVLW	B'11000000'
0735    01C0    00A1    	MOVWF	DATO
0736    01C1    2148    	call	MOVEVALUE
0737    01C2    0008    	RETURN
0738    01C3            ;-----------------------------------------------------------------
0739    01C3            ;							PHOTOCELL
0740    01C3            GET_PHOTOCELL:
0741    01C3            _bucle:
0742    01C3            	;btfss INTCON,T0IF
0743    01C3            	;goto _bucle ;Esperar que el timer0 desborde
0744    01C3            	; SE DEBE DE COLOCAR UN DELAY PARA QUE ESPERE LA CONVERSION
0745    01C3    1503    	BSF  STATUS,Z
0746    01C4    221B    	CALL _PRESPERA
0747    01C5    110B    	bcf INTCON,T0IF ;Limpiar el indicador de desborde
0748    01C6    151F    	bsf ADCON0,GO ;Comenzar conversion A/D
0749    01C7            _espera:
0750    01C7    191F    	btfsc ADCON0,GO ;ADCON0 es 0? (la conversion esta completa?)
0751    01C8    29C7    	goto _espera ;No, ir _espera
0752    01C9    081E    	movf ADRESH,W ;Si, W=ADRESH
0753    01CA            	; 1Eh ADRESH A/D Result Register High Byte
0754    01CA            	; 9Eh ADRESL A/D Result Register Low Byte 
0755    01CA    00B8    	movwf ADC ;ADC=W
0756    01CB    0838    	movfw ADC ;W = ADC
0757    01CC    29CF        	goto  V1
0758    01CD            returnExec:
0759    01CD    20E1    	call 	COMPARE
0760    01CE    0008    	return
0761    01CF            
0762    01CF            V1:
0763    01CF    30D2        movlw D'210'
0764    01D0    0238        subwf ADC, W
0765    01D1    1C03        btfss STATUS, C
0766    01D2    29D7        goto V2
0767    01D3    3000        movlw 0x0
0768    01D4    00AE        movwf waffles
0769    01D5    222C        call case0
0770    01D6    29CD        goto returnExec
0771    01D7            
0772    01D7            V2:
0773    01D7    30C2        movlw D'194'
0774    01D8    0238        subwf ADC, W
0775    01D9    1C03        btfss STATUS, C
0776    01DA    29DF        goto V3
0777    01DB    3001        movlw 0x1
0778    01DC    00AE        movwf waffles
0779    01DD    2234        call case1
0780    01DE    29CD        goto returnExec
0781    01DF            
0782    01DF            V3:
0783    01DF    30AE        movlw D'174'
0784    01E0    0238        subwf ADC, W
0785    01E1    1C03        btfss STATUS, C
0786    01E2    29E7        goto V4
0787    01E3    3002        movlw 0x2
0788    01E4    00AE        movwf waffles
0789    01E5    223C        call case2
0790    01E6    29CD        goto returnExec
0791    01E7            
0792    01E7            V4:
0793    01E7    309E        movlw D'158'
0794    01E8    0238        subwf ADC, W
0795    01E9    1C03        btfss STATUS, C
0796    01EA    29EF        goto V5
0797    01EB    3003        movlw 0x3
0798    01EC    00AE        movwf waffles
0799    01ED    2244        call case3
0800    01EE    29CD        goto returnExec
0801    01EF            
0802    01EF            V5:
0803    01EF    308A        movlw D'138'
0804    01F0    0238        subwf ADC, W
0805    01F1    1C03        btfss STATUS, C
0806    01F2    29F7        goto V6
0807    01F3    3004        movlw 0x4
0808    01F4    00AE        movwf waffles
0809    01F5    224C        call case4
0810    01F6    29CD        goto returnExec
0811    01F7            
0812    01F7            V6:
0813    01F7    3075        movlw D'117'
0814    01F8    0238        subwf ADC, W
0815    01F9    1C03        btfss STATUS, C
0816    01FA    29FF        goto V7
0817    01FB    3005        movlw 0x5
0818    01FC    00AE        movwf waffles
0819    01FD    2254        call case5
0820    01FE    29CD        goto returnExec
0821    01FF            
0822    01FF            V7:
0823    01FF    3052        movlw D'82'
0824    0200    0238        subwf ADC, W
0825    0201    1C03        btfss STATUS, C
0826    0202    2A07        goto V8
0827    0203    3006        movlw 0x6
0828    0204    00AE        movwf waffles
0829    0205    225C        call case6
0830    0206    29CD        goto returnExec
0831    0207            
0832    0207            V8:
0833    0207    3033        movlw D'51'
0834    0208    0238        subwf ADC, W
0835    0209    1C03        btfss STATUS, C
0836    020A    2A0F        goto V9
0837    020B    3007        movlw 0x7
0838    020C    00AE        movwf waffles
0839    020D    2264        call case7
0840    020E    29CD        goto returnExec
0841    020F            
0842    020F            V9:
0843    020F    301C        movlw D'28'
0844    0210    0238        subwf ADC, W
0845    0211    1C03        btfss STATUS, C
0846    0212    2A17        goto V10
0847    0213    3008        movlw 0x8
0848    0214    00AE        movwf waffles
0849    0215    226C        call case8
0850    0216    29CD        goto returnExec
0851    0217            
0852    0217            V10:
0853    0217                ; movlw D'0'
0854    0217                ; subwf ADC, W
0855    0217                ; btfss STATUS, N
0856    0217                ; goto V10<--
0857    0217                ;btfsc STATUS, C
0858    0217    3009        movlw 0x9
0859    0218    00AE        movwf waffles
0860    0219    2274        call case9
0861    021A    29CD        goto returnExec
0862    021B            
0863    021B            _PRESPERA:
0864    021B    30FF    	MOVLW 0XFF
0865    021C    00C0    	MOVWF CounterA
0866    021D    00BF    	MOVWF COUNTERb
0867    021E    00BE    	MOVWF COUNTERc	
0868    021F    2221    	CALL ESPE
0869    0220    0008    	RETURN	
0870    0221            	
0871    0221            ESPE:
0872    0221    0BC0    	DECFSZ	CounterA,0X01
0873    0222    2A21    	GOTO	ESPE
0874    0223    2225    	CALL	ESPE2
0875    0224    0008    	RETURN
0876    0225            ESPE2:
0877    0225    0BBF    	DECFSZ	COUNTERb,0X01
0878    0226    2A25    	GOTO	ESPE2
0879    0227    2229    	CALL	ESPE3
0880    0228    0008    	RETURN
0881    0229            ESPE3:
0882    0229    0BBE    	DECFSZ	COUNTERc,0X01
0883    022A    2A29    	GOTO	ESPE3
0884    022B    0008    	RETURN	
0885    022C            
0886    022C            case0
0887    022C    1485        bsf PORTA, 1
0888    022D    1505        bsf PORTA, 2
0889    022E    1585        bsf PORTA, 3
0890    022F    1605        bsf PORTA, 4
0891    0230    1685        bsf PORTA, 5
0892    0231    1409        bsf PORTE, 0
0893    0232    1089        bcf PORTE, 1
0894    0233    0008        return 
0895    0234            case1
0896    0234                ;movlw 0x0
0897    0234    1085        bcf PORTA, 1
0898    0235    1205        bcf PORTA, 4
0899    0236    1285        bcf PORTA, 5
0900    0237    1009        bcf PORTE, 0
0901    0238    1089        bcf PORTE, 1
0902    0239                ;movlw 0x1
0903    0239    1505        bsf PORTA, 2
0904    023A    1585        bsf PORTA, 3
0905    023B    0008        return
0906    023C            case2
0907    023C                ;movlw 0x1
0908    023C    1485        bsf PORTA, 1
0909    023D    1505        bsf PORTA, 2
0910    023E    1605        bsf PORTA, 4
0911    023F    1685        bsf PORTA, 5
0912    0240    1489        bsf PORTE, 1
0913    0241                ;movlw 0x0
0914    0241    1185        bcf PORTA, 3
0915    0242    1009        bcf PORTE, 0
0916    0243    0008        return
0917    0244            case3
0918    0244                ;movlw 0x1
0919    0244    1485        bsf PORTA, 1
0920    0245    1505        bsf PORTA, 2
0921    0246    1585        bsf PORTA, 3
0922    0247    1605        bsf PORTA, 4
0923    0248    1489        bsf PORTE, 1
0924    0249                ;movlw 0x0
0925    0249    1009        bcf PORTE, 0
0926    024A    1285        bcf PORTA, 5
0927    024B    0008        return
0928    024C            case4
0929    024C                ;movlw 0x1
0930    024C    1505        bsf PORTA, 2
0931    024D    1585        bsf PORTA, 3
0932    024E    1409        bsf PORTE, 0
0933    024F    1489        bsf PORTE, 1
0934    0250                ;movlw 0x0
0935    0250    1085        bcf PORTA, 1
0936    0251    1205        bcf PORTA, 4
0937    0252    1285        bcf PORTA, 5
0938    0253    0008        return
0939    0254            case5
0940    0254                ;movlw 0x1
0941    0254    1585        bsf PORTA, 3
0942    0255    1605        bsf PORTA, 4
0943    0256    1409        bsf PORTE, 0
0944    0257    1489        bsf PORTE, 1
0945    0258    1485        bsf PORTA, 1
0946    0259                ;movlw 0x0
0947    0259    1285        bcf PORTA, 5
0948    025A    1105        bcf PORTA, 2
0949    025B    0008        return
0950    025C            case6
0951    025C                ;movlw 0x1
0952    025C    1585        bsf PORTA, 3
0953    025D    1605        bsf PORTA, 4
0954    025E    1685        bsf PORTA, 5
0955    025F    1409        bsf PORTE, 0
0956    0260    1489        bsf PORTE, 1
0957    0261    1485        bsf PORTA, 1
0958    0262                ;movlw 0x0
0959    0262    1105        bcf PORTA, 2
0960    0263    0008        return
0961    0264            case7
0962    0264                ;movlw 0x1
0963    0264    1485        bsf PORTA, 1
0964    0265    1505        bsf PORTA, 2
0965    0266    1585        bsf PORTA, 3
0966    0267                ;movlw 0x0
0967    0267    1205        bcf PORTA, 4
0968    0268    1285        bcf PORTA, 5
0969    0269    1009        bcf PORTE, 0
0970    026A    1089        bcf PORTE, 1
0971    026B    0008        return
0972    026C            case8
0973    026C                ;movlw 0x1
0974    026C    1485        bsf PORTA, 1
0975    026D    1505        bsf PORTA, 2
0976    026E    1585        bsf PORTA, 3
0977    026F    1605        bsf PORTA, 4
0978    0270    1685        bsf PORTA, 5
0979    0271    1409        bsf PORTE, 0
0980    0272    1489        bsf PORTE, 1
0981    0273    0008        return
0982    0274            case9
0983    0274                ;movlw 0x1
0984    0274    1485        bsf PORTA, 1
0985    0275    1505        bsf PORTA, 2
0986    0276    1585        bsf PORTA, 3
0987    0277    1605        bsf PORTA, 4
0988    0278    1409        bsf PORTE, 0
0989    0279    1489        bsf PORTE, 1
0990    027A                ;movlw 0x0
0991    027A    1285        bcf PORTA, 5
0992    027B    0008        return
0993    027C            ;-------------------------------------------------------------
0994    027C            				;SHOW VALUE OF PHOTOCELL
0995    027C            SHOWVARDISPLAY: ;show varphotocell on display
0996    027C    3000     	movlw 0x00
0997    027D    0236        subwf VARDISPLAY, W
0998    027E    1903        BTFSC STATUS, z
0999    027F    2AA5        goto  case0d
1000    0280            
1001    0280    3001     	movlw 0x01
1002    0281    0236        subwf VARDISPLAY, W
1003    0282    1903        BTFSC STATUS, z
1004    0283    2AB1        goto  case1d
1005    0284            
1006    0284    3002    	movlw 0x02
1007    0285    0236        subwf VARDISPLAY, W
1008    0286    1903        BTFSC STATUS, z
1009    0287    2ABD        goto  case2d
1010    0288            
1011    0288    3003     	movlw 0x03
1012    0289    0236        subwf VARDISPLAY, W
1013    028A    1903        BTFSC STATUS, z
1014    028B    2AC9        goto  case3d
1015    028C            
1016    028C    3004     	movlw 0x04
1017    028D    0236        subwf VARDISPLAY, W
1018    028E    1903        BTFSC STATUS, z
1019    028F    2AD5        goto  case4d
1020    0290            
1021    0290    3005    	movlw 0x05
1022    0291    0236        subwf VARDISPLAY, W
1023    0292    1903        BTFSC STATUS, z
1024    0293    2AE1        goto  case5d
1025    0294            
1026    0294    3006     	movlw 0x06
1027    0295    0236        subwf VARDISPLAY, W
1028    0296    1903        BTFSC STATUS, z
1029    0297    2AED        goto  case6d
1030    0298            
1031    0298    3007     	movlw 0x07
1032    0299    0236        subwf VARDISPLAY, W
1033    029A    1903        BTFSC STATUS, z
1034    029B    2AF9        goto  case7d
1035    029C            
1036    029C    3008     	movlw 0x08
1037    029D    0236        subwf VARDISPLAY, W
1038    029E    1903        BTFSC STATUS, z
1039    029F    2B05        goto  case8d
1040    02A0            
1041    02A0    3009     	movlw 0x09
1042    02A1    0236        subwf VARDISPLAY, W
1043    02A2    1903        BTFSC STATUS, z
1044    02A3    2B11        goto  case9d	
1045    02A4            endshow:
1046    02A4    0008    	RETURN
1047    02A5            
1048    02A5            case0d
1049    02A5    1485        bsf PORTA, 1
1050    02A6    1505        bsf PORTA, 2
1051    02A7    1585        bsf PORTA, 3
1052    02A8    1605        bsf PORTA, 4
1053    02A9    1685        bsf PORTA, 5
1054    02AA    1409        bsf PORTE, 0
1055    02AB    1089        bcf PORTE, 1
1056    02AC            
1057    02AC    1007    	bcf PORTC, 0
1058    02AD    1087    	bcf PORTC, 1
1059    02AE    1107    	bcf PORTC, 2
1060    02AF    1187    	bcf PORTC, 3
1061    02B0    2AA4        goto	endshow
1062    02B1            case1d
1063    02B1    1085        bcf PORTA, 1
1064    02B2    1205        bcf PORTA, 4
1065    02B3    1285        bcf PORTA, 5
1066    02B4    1009        bcf PORTE, 0
1067    02B5    1089        bcf PORTE, 1
1068    02B6    1505        bsf PORTA, 2
1069    02B7    1585        bsf PORTA, 3
1070    02B8            
1071    02B8    1407    	bsf PORTC, 0
1072    02B9    1087    	bcf PORTC, 1
1073    02BA    1107    	bcf PORTC, 2
1074    02BB    1187    	bcf PORTC, 3
1075    02BC    2AA4        goto	endshow
1076    02BD            case2d
1077    02BD    1485        bsf PORTA, 1
1078    02BE    1505        bsf PORTA, 2
1079    02BF    1605        bsf PORTA, 4
1080    02C0    1685        bsf PORTA, 5
1081    02C1    1489        bsf PORTE, 1
1082    02C2    1185        bcf PORTA, 3
1083    02C3    1009        bcf PORTE, 0
1084    02C4            
1085    02C4    1007    	bcf PORTC, 0
1086    02C5    1487    	bsf PORTC, 1
1087    02C6    1107    	bcf PORTC, 2
1088    02C7    1187    	bcf PORTC, 3
1089    02C8    2AA4        goto	endshow
1090    02C9            case3d
1091    02C9    1485        bsf PORTA, 1
1092    02CA    1505        bsf PORTA, 2
1093    02CB    1585        bsf PORTA, 3
1094    02CC    1605        bsf PORTA, 4
1095    02CD    1489        bsf PORTE, 1
1096    02CE    1009        bcf PORTE, 0
1097    02CF    1285        bcf PORTA, 5
1098    02D0            
1099    02D0    1407    	bsf PORTC, 0
1100    02D1    1487    	bsf PORTC, 1
1101    02D2    1107    	bcf PORTC, 2
1102    02D3    1187    	bcf PORTC, 3
1103    02D4    2AA4        goto	endshow
1104    02D5            case4d
1105    02D5    1505        bsf PORTA, 2
1106    02D6    1585        bsf PORTA, 3
1107    02D7    1409        bsf PORTE, 0
1108    02D8    1489        bsf PORTE, 1
1109    02D9    1085        bcf PORTA, 1
1110    02DA    1205        bcf PORTA, 4
1111    02DB    1285        bcf PORTA, 5
1112    02DC            
1113    02DC    1007    	bcf PORTC, 0
1114    02DD    1087    	bcf PORTC, 1
1115    02DE    1507    	bsf PORTC, 2
1116    02DF    1187    	bcf PORTC, 3
1117    02E0    2AA4        goto	endshow
1118    02E1            case5d
1119    02E1    1585        bsf PORTA, 3
1120    02E2    1605        bsf PORTA, 4
1121    02E3    1409        bsf PORTE, 0
1122    02E4    1489        bsf PORTE, 1
1123    02E5    1485        bsf PORTA, 1
1124    02E6    1285        bcf PORTA, 5
1125    02E7    1105        bcf PORTA, 2
1126    02E8            
1127    02E8    1407    	bsf PORTC, 0
1128    02E9    1087    	bcf PORTC, 1
1129    02EA    1507    	bsf PORTC, 2
1130    02EB    1187    	bcf PORTC, 3
1131    02EC    2AA4        goto	endshow
1132    02ED            case6d
1133    02ED    1585        bsf PORTA, 3
1134    02EE    1605        bsf PORTA, 4
1135    02EF    1685        bsf PORTA, 5
1136    02F0    1409        bsf PORTE, 0
1137    02F1    1489        bsf PORTE, 1
1138    02F2    1485        bsf PORTA, 1
1139    02F3    1105        bcf PORTA, 2
1140    02F4            
1141    02F4    1007    	bcf PORTC, 0
1142    02F5    1487    	bsf PORTC, 1
1143    02F6    1507    	bsf PORTC, 2
1144    02F7    1187    	bcf PORTC, 3
1145    02F8    2AA4        goto	endshow
1146    02F9            case7d
1147    02F9    1485        bsf PORTA, 1
1148    02FA    1505        bsf PORTA, 2
1149    02FB    1585        bsf PORTA, 3
1150    02FC    1205        bcf PORTA, 4
1151    02FD    1285        bcf PORTA, 5
1152    02FE    1009        bcf PORTE, 0
1153    02FF    1089        bcf PORTE, 1
1154    0300            
1155    0300    1407    	bsf PORTC, 0
1156    0301    1487    	bsf PORTC, 1
1157    0302    1507    	bsf PORTC, 2
1158    0303    1187    	bcf PORTC, 3
1159    0304    2AA4        goto	endshow
1160    0305            case8d
1161    0305    1485        bsf PORTA, 1
1162    0306    1505        bsf PORTA, 2
1163    0307    1585        bsf PORTA, 3
1164    0308    1605        bsf PORTA, 4
1165    0309    1685        bsf PORTA, 5
1166    030A    1409        bsf PORTE, 0
1167    030B    1489        bsf PORTE, 1
1168    030C            
1169    030C    1007    	bcf PORTC, 0
1170    030D    1087    	bcf PORTC, 1
1171    030E    1107    	bcf PORTC, 2
1172    030F    1587    	bsf PORTC, 3
1173    0310    2AA4        goto	endshow
1174    0311            case9d
1175    0311    1485        bsf PORTA, 1
1176    0312    1505        bsf PORTA, 2
1177    0313    1585        bsf PORTA, 3
1178    0314    1605        bsf PORTA, 4
1179    0315    1409        bsf PORTE, 0
1180    0316    1489        bsf PORTE, 1
1181    0317    1285        bcf PORTA, 5
1182    0318            
1183    0318    1407    	bsf PORTC, 0
1184    0319    1087    	bcf PORTC, 1
1185    031A    1107    	bcf PORTC, 2
1186    031B    1587    	bsf PORTC, 3
1187    031C    2AA4        goto	endshow
1188    031D            ;----------------------------------------------------------------------------------
1189    031D            					;COMUNICACION
1190    031D            ENVIARDEC ; Decide que enviar encicladamente
1191    031D    213E    	CALL	DELAY_D
1192    031E    3001    	MOVLW	B'00000001'
1193    031F    0243    	SUBWF	CONE, 0
1194    0320    1903    	BTFSC	STATUS, Z
1195    0321    2355    	CALL	ENVIARGM ; enviar grupo mayor
1196    0322    213E    	CALL	DELAY_D
1197    0323    3002    	MOVLW	B'00000010'
1198    0324    0243    	SUBWF	CONE, 0
1199    0325    1903    	BTFSC	STATUS, Z
1200    0326    235B    	CALL	ENVIARVM ; enviar valor mayor
1201    0327    213E    	CALL	DELAY_D
1202    0328    3003    	MOVLW	B'00000011'
1203    0329    0243    	SUBWF	CONE, 0
1204    032A    1903    	BTFSC	STATUS, Z
1205    032B    2361    	CALL	ENVIARGMM ; enviar grupo menor
1206    032C    213E    	CALL	DELAY_D
1207    032D    3004    	MOVLW	B'00000100'
1208    032E    0243    	SUBWF	CONE, 0
1209    032F    1903    	BTFSC	STATUS, Z
1210    0330    2367    	CALL	ENVIARVMM ; enviar valor menor
1211    0331    213E    	CALL	DELAY_D
1212    0332    3005    	MOVLW	B'00000101'
1213    0333    0243    	SUBWF	CONE, 0
1214    0334    1903    	BTFSC	STATUS, Z
1215    0335    238F    	CALL	FINENV; hacer comparacion	
1216    0336    0AC3    	INCF	CONE, 1	
1217    0337    0008    	RETURN
1218    0338            
1219    0338            SETBITS
1220    0338    1821    	BTFSC	DATO, 0
1221    0339    2B45    	GOTO	SET11
1222    033A    2B47    	GOTO	SET10
1223    033B            SETBITS1
1224    033B    18A1    	BTFSC	DATO, 1
1225    033C    2B49    	GOTO	SET21
1226    033D    2B4B    	GOTO	SET20
1227    033E            SETBITS2
1228    033E    1921    	BTFSC	DATO, 2
1229    033F    2B4D    	GOTO	SET31
1230    0340    2B4F    	GOTO	SET30
1231    0341            SETBITS3
1232    0341    19A1    	BTFSC	DATO, 3
1233    0342    2B51    	GOTO	SET41
1234    0343    2B53    	GOTO	SET40
1235    0344            ENDSET
1236    0344    0008    	RETURN	
1237    0345            
1238    0345            SET11
1239    0345            	;BSF	PORTB, 1
1240    0345    1607    	BSF	PORTC, 4 ;***************************
1241    0346    2B3B    	GOTO	SETBITS1
1242    0347            SET10
1243    0347            	;BCF	PORTB, 1
1244    0347    1607    	BSF	PORTC, 4 ;***************************
1245    0348    2B3B    	GOTO	SETBITS1
1246    0349            	
1247    0349            SET21
1248    0349            	;BSF	PORTB, 2
1249    0349    1687    	BSF	PORTC, 5 ;***************************
1250    034A    2B3E    	GOTO	SETBITS2
1251    034B            SET20
1252    034B            	;BCF	PORTB, 2
1253    034B    1687    	BSF	PORTC, 5 ;***************************
1254    034C    2B3E    	GOTO	SETBITS2
1255    034D            	
1256    034D            SET31
1257    034D            	;BSF	PORTB, 3
1258    034D    1707    	BSF	PORTC, 6 ;***************************
1259    034E    2B41    	GOTO	SETBITS3
1260    034F            SET30
1261    034F            	;BCF	PORTB, 3
1262    034F    1707    	BSF	PORTC, 6 ;***************************
1263    0350    2B41    	GOTO	SETBITS3
1264    0351            	
1265    0351            SET41
1266    0351            	;BSF	PORTB, 4
1267    0351    1787    	BSF	PORTC, 7 ;***************************
1268    0352    2B44    	GOTO	ENDSET
1269    0353            SET40
1270    0353            	;BCF	PORTB, 4
1271    0353    1787    	BSF	PORTC, 7 ;***************************
1272    0354    2B44    	GOTO	ENDSET
1273    0355            	
1274    0355            ENVIARGM
1275    0355    0844    	MOVF	MAYG, W
1276    0356    00A1    	MOVWF 	DATO
1277    0357    2338    	CALL	SETBITS
1278    0358            	;BTFSC	PORTB, 0
1279    0358    1B08    	BTFSC	PORTD, 6 ;***********************
1280    0359    2B55    	GOTO	ENVIARGM 
1281    035A    0008    	RETURN
1282    035B            	
1283    035B            ENVIARVM
1284    035B    0845    	MOVF	MAYV, W
1285    035C    00A1    	MOVWF 	DATO
1286    035D    2338    	CALL	SETBITS	
1287    035E            	;BTFSC	PORTB, 0
1288    035E    1B08    	BTFSC	PORTD, 6 ;***********************
1289    035F    2B5B    	GOTO	ENVIARVM 
1290    0360    0008    	RETURN
1291    0361            	
1292    0361            ENVIARGMM
1293    0361    0846    	MOVF	MENG, W
1294    0362    00A1    	MOVWF 	DATO
1295    0363    2338    	CALL	SETBITS	
1296    0364            	;BTFSC	PORTB, 0
1297    0364    1B08    	BTFSC	PORTD, 6 ;***********************
1298    0365    2B61    	GOTO	ENVIARGMM 
1299    0366    0008    	RETURN
1300    0367            	
1301    0367            ENVIARVMM
1302    0367    0847    	MOVF	MENV, W
1303    0368    00A1    	MOVWF 	DATO
1304    0369    2338    	CALL	SETBITS	
1305    036A            	;BTFSC	PORTB, 0
1306    036A    1B08    	BTFSC	PORTD, 6 ;***********************
1307    036B    2B67    	GOTO	ENVIARVMM 
1308    036C    0008    	RETURN
1309    036D            
1310    036D            RECIBIRDEC ; recibe encicladamente
1311    036D    213E    	CALL	DELAY_D
1312    036E    3001    	MOVLW	B'00000001'
1313    036F    0242    	SUBWF	CONR, 0
1314    0370    1903    	BTFSC	STATUS, Z
1315    0371    23B1    	CALL	RECIBIRGM ; enviar grupo mayor
1316    0372    213E    	CALL	DELAY_D
1317    0373    3002    	MOVLW	B'00000010'
1318    0374    0242    	SUBWF	CONR, 0
1319    0375    1903    	BTFSC	STATUS, Z
1320    0376    23B7    	CALL	RECIBIRVM ; enviar valor mayor
1321    0377    213E    	CALL	DELAY_D
1322    0378    3003    	MOVLW	B'00000011'
1323    0379    0242    	SUBWF	CONR, 0
1324    037A    1903    	BTFSC	STATUS, Z
1325    037B    23BD    	CALL	RECIBIRGMM ; enviar grupo menor
1326    037C    213E    	CALL	DELAY_D
1327    037D    3004    	MOVLW	B'00000100'
1328    037E    0242    	SUBWF	CONR, 0
1329    037F    1903    	BTFSC	STATUS, Z
1330    0380    23C3    	CALL	RECIBIRVMM ; enviar valor menor	
1331    0381    213E    	CALL	DELAY_D
1332    0382    3005    	MOVLW	B'00000101'
1333    0383    0242    	SUBWF	CONR, 0
1334    0384    1903    	BTFSC	STATUS, Z
1335    0385    2388    	CALL	FINREC; hacer comparacion	
1336    0386    0AC2    	INCF	CONR, 1			
1337    0387    0008    	RETURN
1338    0388            	
1339    0388            FINREC
1340    0388    3000    	MOVLW	B'00000000'
1341    0389    00C2    	MOVWF   CONR
1342    038A    23C9    	CALL	COMPAREMAYORG
1343    038B    23D4    	CALL	COMPAREMENORG
1344    038C    1808    	BTFSC	PORTD, 0
1345    038D    2B88    	GOTO	FINREC 
1346    038E    0008    	RETURN
1347    038F            	
1348    038F            FINENV
1349    038F    3000    	MOVLW	B'00000000'
1350    0390    00C3    	MOVWF   CONE
1351    0391            	;BTFSC	PORTB, 0
1352    0391    1B08    	BTFSC	PORTD, 6 ;****************************
1353    0392    2B8F    	GOTO	FINENV
1354    0393    0008    	RETURN
1355    0394            	
1356    0394            SET11R
1357    0394    1421    	BSF	DATO, 0
1358    0395    2BA7    	GOTO	SETBITS1R
1359    0396            SET10R
1360    0396    1021    	BCF	DATO, 0
1361    0397    2BA7    	GOTO	SETBITS1R
1362    0398            	
1363    0398            SET21R
1364    0398    14A1    	BSF	DATO, 1
1365    0399    2BAA    	GOTO	SETBITS2R
1366    039A            SET20R
1367    039A    10A1    	BCF	DATO, 1
1368    039B    2BAA    	GOTO	SETBITS2R
1369    039C            	
1370    039C            SET31R
1371    039C    1521    	BSF	DATO, 2
1372    039D    2BAD    	GOTO	SETBITS3R
1373    039E            SET30R
1374    039E    1121    	BCF	DATO, 2
1375    039F    2BAD    	GOTO	SETBITS3R
1376    03A0            	
1377    03A0            SET41R
1378    03A0    15A1    	BSF	DATO, 3
1379    03A1    2BB0    	GOTO	ENDSETR
1380    03A2            SET40R
1381    03A2    11A1    	BCF	DATO, 3
1382    03A3    2BB0    	GOTO	ENDSETR
1383    03A4            
1384    03A4            SETBITSR
1385    03A4    1987    	BTFSC	PORTC, 3
1386    03A5    2B94    	GOTO	SET11R
1387    03A6    2B96    	GOTO	SET10R
1388    03A7            SETBITS1R
1389    03A7    1907    	BTFSC	PORTC, 2
1390    03A8    2B98    	GOTO	SET21R
1391    03A9    2B9A    	GOTO	SET20R
1392    03AA            SETBITS2R
1393    03AA    1887    	BTFSC	PORTC, 1
1394    03AB    2B9C    	GOTO	SET31R
1395    03AC    2B9E    	GOTO	SET30R
1396    03AD            SETBITS3R
1397    03AD    1807    	BTFSC	PORTC, 0
1398    03AE    2BA0    	GOTO	SET41R
1399    03AF    2BA2    	GOTO	SET40R
1400    03B0            ENDSETR
1401    03B0    0008    	RETURN	
1402    03B1            
1403    03B1            	
1404    03B1            RECIBIRGM
1405    03B1    23A4    	CALL	SETBITSR
1406    03B2    0821    	MOVF	DATO, W
1407    03B3    00C8    	MOVWF	MAYBG
1408    03B4    1808    	BTFSC	PORTD, 0
1409    03B5    2BB1    	GOTO	RECIBIRGM 
1410    03B6    0008    	RETURN	
1411    03B7            	
1412    03B7            RECIBIRVM
1413    03B7    23A4    	CALL	SETBITSR
1414    03B8    0821    	MOVF	DATO, W
1415    03B9    00C9    	MOVWF	MAYBV
1416    03BA    1808    	BTFSC	PORTD, 0
1417    03BB    2BB7    	GOTO	RECIBIRVM 
1418    03BC    0008    	RETURN
1419    03BD            
1420    03BD            RECIBIRGMM
1421    03BD    23A4    	CALL	SETBITSR
1422    03BE    0821    	MOVF	DATO, W
1423    03BF    00CA    	MOVWF	MENBG
1424    03C0    1808    	BTFSC	PORTD, 0
1425    03C1    2BBD    	GOTO	RECIBIRGMM 
1426    03C2    0008    	RETURN	
1427    03C3            
1428    03C3            RECIBIRVMM
1429    03C3    23A4    	CALL	SETBITSR
1430    03C4    0821    	MOVF	DATO, W
1431    03C5    00CB    	MOVWF	MENBV
1432    03C6    1808    	BTFSC	PORTD, 0
1433    03C7    2BC3    	GOTO	RECIBIRVMM 
1434    03C8    0008    	RETURN
1435    03C9            
1436    03C9            COMPAREMAYORG 
1437    03C9    0845    	MOVF  MAYV, W
1438    03CA    0249    	SUBWF MAYBV, W
1439    03CB    1C03    	BTFSS STATUS, C       
1440    03CC    2BD3    	GOTO  NOCHANGEMAY
1441    03CD    2BCE    	GOTO  CHANGEMAY	                        
1442    03CE            
1443    03CE            CHANGEMAY
1444    03CE    0848    	MOVF  MAYBG, W 
1445    03CF    00C4            MOVWF MAYG
1446    03D0    0849            MOVF  MAYBV, W
1447    03D1    00C5            MOVWF MAYV
1448    03D2    0008    	RETURN
1449    03D3            
1450    03D3            NOCHANGEMAY
1451    03D3    0008    	RETURN
1452    03D4            	
1453    03D4            COMPAREMENORG 
1454    03D4    0847    	MOVF  MENV, W
1455    03D5    024B    	SUBWF MENBV, W
1456    03D6    1C03    	BTFSS STATUS, C  
1457    03D7    2BD9    	GOTO  CHANGEMEN     
1458    03D8    2BDE    	GOTO  NOCHANGEMEN	                        
1459    03D9            
1460    03D9            CHANGEMEN
1461    03D9    084A    	MOVF  MENBG, W 
1462    03DA    00C6            MOVWF MENG
1463    03DB    084B            MOVF  MENBV, W
1464    03DC    00C7            MOVWF MENV
1465    03DD    0008    	RETURN
1466    03DE            
1467    03DE            NOCHANGEMEN
1468    03DE    0008    	RETURN
1469    03DF            END
---------------------------------------------
Number of errors = 0
