---------------------------------------------
PIC ASSEMBLER LISTING
Line    Address Opcode  Instruction
---------------------------------------------
0001    0000            
0002    0000            DATO  	EQU 0x21
0003    0000            COUNTY 	EQU 0x22
0004    0000            COUNTX 	EQU 0x23
0005    0000            LIMITY 	EQU 0x24
0006    0000            LIMITX 	EQU 0x25
0007    0000            P1	  	EQU 0x26
0008    0000            P2    	EQU 0x27
0009    0000            COUNTBETA EQU 0x28
0010    0000            LIMITBETA EQU 0x29
0011    0000            
0012    0000            VARPHOTOCELL EQU 0x2A
0013    0000            TMPCELL EQU 0x2B
0014    0000            TMPY    EQU 0x2C
0015    0000            TMPX    EQU 0x2E
0016    0000            TMPBETA EQU 0x2F
0017    0000            LIMITMAXX   EQU 0x30
0018    0000            LIMITMAXY   EQU 0x31
0019    0000            LIMITMAXBETA EQU 0x32
0020    0000            
0021    0000            varA    EQU 0x33
0022    0000            varB    EQU 0x34
0023    0000            varC    EQU 0x35
0024    0000            VARDISPLAY  EQU 0x36
0025    0000            cont    EQU 0x37 
0026    0000            ADC     EQU 0x38
0027    0000            CON     EQU 0x39
0028    0000            CON2    EQU 0x3A
0029    0000            CON3    EQU 0x3B
0030    0000            GROUPNUMBER	EQU 0x3C
0031    0000            
0032    0000            waffles EQU 0x3D
0033    0000            CounterC EQU 0x3E
0034    0000            CounterB EQU 0x3F
0035    0000            CounterA EQU 0x40
0036    0000            INICIO
0037    0000            
0038    0000            	ORG		0x00
0039    0000    2801    	GOTO	START
0040    0001            
0041    0001            START
0042    0001            	;1 = in        0  = out
0043    0001            	;BIT SET FILE
0044    0001    1683    	BSF 	STATUS, 5; COLOCAMOS EN S EL BIT 5 DE REG. ESTATUS
0045    0002    0186    	CLRF	TRISB
0046    0003    0188    	CLRF	TRISD   
0047    0004            	                    ;BIT CLEARE FILE
0048    0004    1283    	BCF		STATUS, RP0 ;TODOS LOS PINES DE B SON SALIDAS
0049    0005            
0050    0005    3000    	MOVLW	0x00
0051    0006    0086    	MOVWF 	PORTB  ; SET 0 TO ALL PORTS B
0052    0007    3000    	MOVLW	0x00
0053    0008    0088    	MOVWF 	PORTD  ; SET 0 TO ALL PORTS B
0054    0009    30E6    	MOVLW 	0xE6        ;NUMBER OF MOVES/STOPS IN Y, E6h = 230d
0055    000A    00A4    	MOVWF 	LIMITY 
0056    000B    00B1    	MOVWF	LIMITMAXY
0057    000C    3020    	MOVLW 	0x20        ;NUMBER OF MOVES IN X
0058    000D    00A5    	MOVWF 	LIMITX 
0059    000E    00B0    	MOVWF	LIMITMAXX
0060    000F    3010    	MOVLW	0x10	    ;NUMBER OF STOPS IN X, 10h = 16d
0061    0010    00A9    	MOVWF	LIMITBETA
0062    0011    00B2    	MOVWF	LIMITMAXBETA
0063    0012    20B5    	call 	CLEANY      ;SET COUNTERS TO 0
0064    0013    20B8    	call 	CLEANX
0065    0014    20BB    	call 	CLEANBETA
0066    0015    20BE    	call 	CLEANVARPHOTOCELL
0067    0016            ;------------------------------------------------------------------------------
0068    0016                            ;CONFIGURATION FOR THE PHOTOCELL 
0069    0016    1283    	bcf STATUS,RP0 ;Ir banco 0
0070    0017    1303    	bcf STATUS,RP1
0071    0018    3041    	movlw b'01000001' ;A/D conversion Fosc/8
0072    0019    009F    	movwf ADCON0
0073    001A            	;     	     7     6     5    4    3    2       1 0
0074    001A            	; 1Fh ADCON0 ADCS1 ADCS0 CHS2 CHS1 CHS0 GO/DONE ? ADON
0075    001A    1683    	bsf STATUS,RP0 ;Ir banco 1
0076    001B    1303    	bcf STATUS,RP1
0077    001C    3007    	movlw b'00000111'
0078    001D    0081    	movwf OPTION_REG ;TMR0 preescaler, 1:156
0079    001E            	;                7    6      5    4    3   2   1   0 
0080    001E            	; 81h OPTION_REG RBPU INTEDG T0CS T0SE PSA PS2 PS1 PS0
0081    001E    300E    	movlw b'00001110' ;A/D Port AN0/RA0
0082    001F    009F    	movwf ADCON1
0083    0020            	;            7    6     5 4 3     2     1     0 
0084    0020            	; 9Fh ADCON1 ADFM ADCS2 ? ? PCFG3 PCFG2 PCFG1 PCFG0
0085    0020    1405    	bsf TRISA,0 ;RA0 linea de entrada para el ADC
0086    0021                	;Port A: display output
0087    0021    1085        	bcf	TRISA, 1
0088    0022    1105       	bcf	TRISA, 2
0089    0023    1185        	bcf	TRISA, 3
0090    0024    1205       	bcf	TRISA, 4
0091    0025    1285        	bcf	TRISA, 5
0092    0026    1009        	bcf	TRISE, 0
0093    0027    1089        	bcf	TRISE, 1
0094    0028    0186    	clrf TRISB
0095    0029    1283    	bcf STATUS,RP0 ;Ir banco 0
0096    002A    1303    	bcf STATUS,RP1
0097    002B            ;--------------------------------------------------------------------
0098    002B            ;--------------------------------------------------------------------
0099    002B            						;MAIN
0100    002B            MAIN:
0101    002B    2031        call    SEARCH      ;SEARCH BEST POINT
0102    002C    203C        call    MOVEGREATER ;GO TO BEST POINT
0103    002D            WAIT:   
0104    002D                ;DO STUFF WITH THE BUTTON
0105    002D                ;BTFSS	BUTTON
0106    002D    282D        GOTO    WAIT
0107    002E    2045        call    RESTART      ;RETURN TO ORIGINAL POSITION & CLEAN EVERYTHING
0108    002F    282B        GOTO    MAIN
0109    0030    29E3        GOTO    END
0110    0031            SEARCH:
0111    0031    2085    	call	LOOPX ; MOVE X AND Y
0112    0032            
0113    0032    0828    	MOVFW 	COUNTBETA
0114    0033    00AF    	MOVWF	TMPBETA
0115    0034            
0116    0034    0AA8    	INCF	COUNTBETA,1
0117    0035    0829    	MOVF	LIMITBETA, W	
0118    0036    0228    	SUBWF	COUNTBETA, w
0119    0037    1D03    	BTFSS	STATUS,Z
0120    0038    2831    	GOTO	SEARCH
0121    0039    20BB    	call	CLEANBETA   ;CLEAN COUNTBETA
0122    003A    207E    	call 	LOOPBETAREVERSE    ;RETURN TO ORIGINAL POSITION
0123    003B    0008        RETURN
0124    003C            
0125    003C            ;------------------------------------------------------------------
0126    003C                                    ;MOVE TO GREATER
0127    003C            MOVEGREATER:
0128    003C    2050    	call	LOOPXMAX ; MOVE X 
0129    003D            
0130    003D    0AA8    	INCF	COUNTBETA,1
0131    003E    0832    	MOVF	LIMITMAXBETA, W	
0132    003F    0228    	SUBWF	COUNTBETA, w
0133    0040    1D03    	BTFSS	STATUS,Z
0134    0041    283C    	GOTO	MOVEGREATER
0135    0042    2058        call	LOOPYMAX ; MOVE Y
0136    0043    20BB        call	CLEANBETA
0137    0044    0008        RETURN
0138    0045            
0139    0045            RESTART:
0140    0045    2049        call    LOOPMAXBETAREVERSE
0141    0046    2060        call 	LOOPYREVERSEMAX
0142    0047    20BE    	call 	CLEANVARPHOTOCELL
0143    0048    0008        RETURN
0144    0049            
0145    0049            LOOPMAXBETAREVERSE:
0146    0049    2068    	call 	LOOPXREVERSEMAX
0147    004A            	
0148    004A    0AA8    	INCF	COUNTBETA,1
0149    004B    0832    	MOVF	LIMITMAXBETA, W	
0150    004C    0228    	SUBWF	COUNTBETA, w
0151    004D    1D03    	BTFSS	STATUS,Z
0152    004E    2849    	GOTO	LOOPMAXBETAREVERSE
0153    004F    0008        RETURN
0154    0050            
0155    0050            LOOPXMAX:
0156    0050    20C1    	call 	EJEX
0157    0051            
0158    0051            	;MOVE ON X
0159    0051    0AA3        INCF    COUNTX,1    
0160    0052    0830    	MOVF  	LIMITMAXX, w
0161    0053    0223    	SUBWF 	COUNTX,w
0162    0054    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT < limitx
0163    0055    2850    	GOTO 	LOOPXMAX	; JUMP IF COUNT !=  limitx
0164    0056            	
0165    0056    20B8    	call 	CLEANX
0166    0057    0008    	RETURN
0167    0058            
0168    0058            LOOPYMAX:
0169    0058    20C6    	call 	EJEY
0170    0059            	;MOVE ON Y
0171    0059    0AA2        INCF    COUNTY,1 ;count++
0172    005A    0831    	MOVF  	LIMITMAXY, w
0173    005B    0222    	SUBWF 	COUNTY,w
0174    005C    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT < limity
0175    005D    2858    	GOTO 	LOOPYMAX	; JUMP IF COUNT !=  limity
0176    005E            	;RESET  countY
0177    005E    20B5    	call 	CLEANY
0178    005F    0008    	return
0179    0060            
0180    0060            
0181    0060            LOOPYREVERSEMAX:
0182    0060    20CB    	call 	REVERSEEJEY
0183    0061    0AA2        INCF    COUNTY,1
0184    0062    0831    	MOVF  	LIMITMAXY, w
0185    0063    0222    	SUBWF 	COUNTY,w
0186    0064    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT <32
0187    0065    2860    	GOTO 	LOOPYREVERSEMAX
0188    0066    20B5    	call 	CLEANY
0189    0067    0008    	RETURN
0190    0068            
0191    0068            LOOPXREVERSEMAX:
0192    0068    20D0    	call 	REVERSEEJEX
0193    0069    0AA3        INCF    COUNTX,1
0194    006A            	
0195    006A    0830    	MOVF  	LIMITMAXX, w
0196    006B    0223    	SUBWF 	COUNTX,w
0197    006C    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT <32
0198    006D    2868    	GOTO 	LOOPXREVERSEMAX
0199    006E    20B8    	call 	CLEANX
0200    006F    0008    	RETURN
0201    0070            
0202    0070            ;-------------------------------------------------------------------
0203    0070            ;                   Photocell comparation
0204    0070            	;result		carry zero (status)
0205    0070            	;positive     1		0
0206    0070            	;zero		  1		1
0207    0070            	;negative     0     0
0208    0070            COMPARE: ;ASIGNAR A TMPCELL EL NUMERO EN LA ESCALA DE LUZ (0-9)
0209    0070    082A        MOVF    VARPHOTOCELL,W
0210    0071    022B        SUBWF   TMPCELL, W ; W = VARPHOTOVELL - TMPCELL 
0211    0072    1C03        BTFSS   STATUS, C   ;IF VARPHOTOCELL < TMPCELL ; c=0 if negative
0212    0073    2075        call    CHANGEPHOTOCELL   
0213    0074    2894    	goto 	DimeElGordito 
0214    0075            
0215    0075            CHANGEPHOTOCELL:
0216    0075    082B        MOVFW   TMPCELL
0217    0076    00AA        MOVWF   VARPHOTOCELL  ;PHOTOCELL =  TMPCELL
0218    0077    082C        MOVFW   TMPY
0219    0078    00B1        MOVWF   LIMITMAXY     ;LIMITMAXY = TMPY
0220    0079    082E        MOVFW   TMPX
0221    007A    00B0        MOVWF   LIMITMAXX     ;LIMITMAXX = TMPX
0222    007B    082F        MOVFW   TMPBETA
0223    007C    00B2        MOVWF   LIMITMAXBETA  ;LIMITMAXBETA = TMPBETA
0224    007D    0008        return 
0225    007E            
0226    007E            ;---------------------------------------------------------------------
0227    007E            ;                       LOOPS
0228    007E            LOOPBETAREVERSE:
0229    007E    20A4    	call 	LOOPXREVERSE
0230    007F            	
0231    007F    0AA8    	INCF	COUNTBETA,1
0232    0080    0829    	MOVF	LIMITBETA, W	
0233    0081    0228    	SUBWF	COUNTBETA, w
0234    0082    1D03    	BTFSS	STATUS,Z
0235    0083    287E    	GOTO	LOOPBETAREVERSE
0236    0084    0008    	RETURN
0237    0085            
0238    0085            LOOPX: ; LOOP i <= LIMITX
0239    0085    20C1    	call 	EJEX
0240    0086            
0241    0086    0823    	MOVFW 	COUNTX
0242    0087    00AE    	MOVWF	TMPX
0243    0088            
0244    0088            	;MOVE ON X
0245    0088    0AA3        INCF    COUNTX,1
0246    0089    0825    	MOVF  	LIMITX, w
0247    008A    0223    	SUBWF 	COUNTX,w
0248    008B    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT < limitx
0249    008C    2885    	GOTO 	LOOPX	; JUMP IF COUNT !=  limitx
0250    008D    2090    	call	LOOPY ; MOVE Y
0251    008E            
0252    008E    20B8    	call 	CLEANX
0253    008F    0008    	RETURN
0254    0090            
0255    0090            LOOPY: ;LOOP i <= LIMITY
0256    0090    20C6    	call 	EJEY
0257    0091            
0258    0091    0822    	MOVFW 	COUNTY
0259    0092    00AC    	MOVWF	TMPY
0260    0093            
0261    0093            	;INSERT LOGIC COMPARE VALUE OF PHOTOCELL & SAVE IT
0262    0093                ;maybe add a delay here \o/
0263    0093                ;call    COMPARE
0264    0093    2929    	goto 	GET_PHOTOCELL
0265    0094            DimeElGordito:
0266    0094            
0267    0094            	;MOVE ON Y
0268    0094    0AA2        INCF    COUNTY,1
0269    0095    0824    	MOVF  	LIMITY, w
0270    0096    0222    	SUBWF 	COUNTY,w
0271    0097    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT < limity
0272    0098    2890    	GOTO 	LOOPY	; JUMP IF COUNT !=  limity
0273    0099            	;RESET Y
0274    0099    20B5    	call 	CLEANY
0275    009A    209C    	call 	LOOPYREVERSE
0276    009B    0008    	return
0277    009C            
0278    009C            LOOPYREVERSE:
0279    009C    20CB    	call 	REVERSEEJEY
0280    009D    0AA2        INCF    COUNTY,1
0281    009E    0824    	MOVF  	LIMITY, w
0282    009F    0222    	SUBWF 	COUNTY,w
0283    00A0    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT <32
0284    00A1    289C    	GOTO 	LOOPYREVERSE
0285    00A2    20B5    	call 	CLEANY
0286    00A3    0008    	RETURN
0287    00A4            
0288    00A4            LOOPXREVERSE:
0289    00A4    20D0    	call 	REVERSEEJEX
0290    00A5    0AA3        INCF    COUNTX,1
0291    00A6    0825    	MOVF  	LIMITX, w
0292    00A7    0223    	SUBWF 	COUNTX,w
0293    00A8    1D03    	BTFSS 	STATUS,Z ;CHECK COUNT <32
0294    00A9    28A4    	GOTO 	LOOPXREVERSE
0295    00AA    20B8    	call 	CLEANX
0296    00AB    0008    	RETURN
0297    00AC            ;-------------------------------------------------------------------
0298    00AC            ;						DELAYS
0299    00AC            Delay ; = 0.0001 seconds
0300    00AC            			;496 cycles
0301    00AC    30A5    	movlw	0xA5
0302    00AD    00A6    	movwf	p1
0303    00AE            Delay_0
0304    00AE    0BA6    	decfsz	p1, f
0305    00AF    28AE    	goto	Delay_0
0306    00B0            
0307    00B0            			;4 cycles (including call)
0308    00B0    0008    	return
0309    00B1            ;-------------------------------------------------------------------
0310    00B1            ;						UTILITIES
0311    00B1            MOVEVALUE:	
0312    00B1    20AC    	call 	DELAY
0313    00B2    0821    	MOVF	DATO, W  
0314    00B3    0086    	MOVWF	PORTB	
0315    00B4    0008    	RETURN
0316    00B5            CLEANY:
0317    00B5    3000    	MOVLW 	0x00  ;se asigna la literal a w (0x00)
0318    00B6    00A2    	MOVWF 	COUNTY ;muevo w a COUNT 
0319    00B7    0008    	RETURN
0320    00B8            CLEANX:
0321    00B8    3000    	MOVLW 	0x00  ;se asigna la literal a w (0x00)
0322    00B9    00A3    	MOVWF 	COUNTX ;muevo w a COUNT 
0323    00BA    0008    	RETURN
0324    00BB            CLEANBETA:
0325    00BB    3000    	MOVLW 	0x00  ;se asigna la literal a w (0x00)
0326    00BC    00A8    	MOVWF 	COUNTBETA ;muevo w a COUNT 
0327    00BD    0008    	RETURN
0328    00BE            CLEANVARPHOTOCELL:
0329    00BE    3001    	MOVLW	0x1
0330    00BF    00AA    	MOVWF	VARPHOTOCELL
0331    00C0    0008    	RETURN
0332    00C1            EJEX:	
0333    00C1    20F9    	call	MV12
0334    00C2    20E9    	call	MV06
0335    00C3    20DD    	call	MV03
0336    00C4    20F5    	call	MV09
0337    00C5    0008    	RETURN
0338    00C6            EJEY:	
0339    00C6    2125    	call	MVY12
0340    00C7    2115    	call	MVY6
0341    00C8    2109    	call	MVY3
0342    00C9    2121    	call	MVY9
0343    00CA    0008    	RETURN
0344    00CB            REVERSEEJEY:
0345    00CB            	;call 	DELAY
0346    00CB    2121    	call	MVY9
0347    00CC    2109    	call	MVY3
0348    00CD    2115    	call	MVY6
0349    00CE    2125    	call	MVY12
0350    00CF    0008    	RETURN
0351    00D0            REVERSEEJEX:
0352    00D0    20F5    	call  	MV09
0353    00D1    20DD    	call	MV03
0354    00D2    20E9    	call	MV06
0355    00D3    20F9    	call	MV12
0356    00D4    0008    	RETURN
0357    00D5            
0358    00D5            MV01:	
0359    00D5    3001    	MOVLW	B'00000001'
0360    00D6    00A1    	MOVWF	DATO
0361    00D7    20B1    	call	MOVEVALUE
0362    00D8    0008    	RETURN
0363    00D9            
0364    00D9            MV02:
0365    00D9    3002    	MOVLW	B'00000010'
0366    00DA    00A1    	MOVWF	DATO
0367    00DB    20B1    	call	MOVEVALUE
0368    00DC    0008    	RETURN
0369    00DD            MV03:	
0370    00DD    3003    	MOVLW	B'00000011'
0371    00DE    00A1    	MOVWF	DATO
0372    00DF    20B1    	call	MOVEVALUE
0373    00E0    0008    	RETURN
0374    00E1            
0375    00E1            MV04:
0376    00E1    3004    	MOVLW	B'00000100'
0377    00E2    00A1    	MOVWF	DATO
0378    00E3    20B1    	call	MOVEVALUE
0379    00E4    0008    	RETURN
0380    00E5            MV05:
0381    00E5    3005    	MOVLW	B'00000101'
0382    00E6    00A1    	MOVWF	DATO
0383    00E7    20B1    	call	MOVEVALUE
0384    00E8    0008    	RETURN
0385    00E9            MV06:
0386    00E9    3006    	MOVLW	B'00000110'
0387    00EA    00A1    	MOVWF	DATO
0388    00EB    20B1    	call	MOVEVALUE
0389    00EC    0008    	RETURN
0390    00ED            MV07:
0391    00ED    3007    	MOVLW	B'00000111'
0392    00EE    00A1    	MOVWF	DATO
0393    00EF    20B1    	call	MOVEVALUE
0394    00F0    0008    	RETURN
0395    00F1            MV08:
0396    00F1    3008    	MOVLW	B'00001000'
0397    00F2    00A1    	MOVWF	DATO
0398    00F3    20B1    	call	MOVEVALUE
0399    00F4    0008    	RETURN
0400    00F5            MV09:
0401    00F5    3009    	MOVLW	B'00001001'
0402    00F6    00A1    	MOVWF	DATO
0403    00F7    20B1    	call	MOVEVALUE
0404    00F8    0008    	RETURN
0405    00F9            MV12:
0406    00F9    300C    	MOVLW	B'00001100'
0407    00FA    00A1    	MOVWF	DATO
0408    00FB    20B1    	call	MOVEVALUE
0409    00FC    0008    	RETURN
0410    00FD            MVy0:
0411    00FD    3000    	MOVLW	B'00000000'
0412    00FE    00A1    	MOVWF	DATO
0413    00FF    20B1    	call	MOVEVALUE
0414    0100    0008    	RETURN
0415    0101            MVY1:
0416    0101    3010    	MOVLW	B'00010000'
0417    0102    00A1    	MOVWF	DATO
0418    0103    20B1    	call	MOVEVALUE
0419    0104    0008    	RETURN
0420    0105            MVY2:
0421    0105    3020    	MOVLW	B'00100000'
0422    0106    00A1    	MOVWF	DATO
0423    0107    20B1    	call	MOVEVALUE
0424    0108    0008    	RETURN
0425    0109            MVY3:
0426    0109    3030    	MOVLW	B'00110000'
0427    010A    00A1    	MOVWF	DATO
0428    010B    20B1    	call	MOVEVALUE
0429    010C    0008    	RETURN
0430    010D            MVY4:
0431    010D    3040    	MOVLW	B'01000000'
0432    010E    00A1    	MOVWF	DATO
0433    010F    20B1    	call	MOVEVALUE
0434    0110    0008    	RETURN
0435    0111            MVY5:
0436    0111    3050    	MOVLW	B'01010000'
0437    0112    00A1    	MOVWF	DATO
0438    0113    20B1    	call	MOVEVALUE
0439    0114    0008    	RETURN
0440    0115            MVY6:
0441    0115    3060    	MOVLW	B'01100000'
0442    0116    00A1    	MOVWF	DATO
0443    0117    20B1    	call	MOVEVALUE
0444    0118    0008    	RETURN
0445    0119            MVY7:
0446    0119    3070    	MOVLW	B'01110000'
0447    011A    00A1    	MOVWF	DATO
0448    011B    20B1    	call	MOVEVALUE
0449    011C    0008    	RETURN
0450    011D            MVY8:
0451    011D    3080    	MOVLW	B'10000000'
0452    011E    00A1    	MOVWF	DATO
0453    011F    20B1    	call	MOVEVALUE
0454    0120    0008    	RETURN
0455    0121            MVY9:
0456    0121    3090    	MOVLW	B'10010000'
0457    0122    00A1    	MOVWF	DATO
0458    0123    20B1    	call	MOVEVALUE
0459    0124    0008    	RETURN
0460    0125            MVY12:
0461    0125    30C0    	MOVLW	B'11000000'
0462    0126    00A1    	MOVWF	DATO
0463    0127    20B1    	call	MOVEVALUE
0464    0128    0008    	RETURN
0465    0129            ;-----------------------------------------------------------------
0466    0129            ;							PHOTOCELL
0467    0129            GET_PHOTOCELL:
0468    0129            _bucle:
0469    0129            	;btfss INTCON,T0IF
0470    0129            	;goto _bucle ;Esperar que el timer0 desborde
0471    0129            	; SE DEBE DE COLOCAR UN DELAY PARA QUE ESPERE LA CONVERSION
0472    0129    1503    	BSF  STATUS,Z
0473    012A    2182    	CALL _PRESPERA
0474    012B    110B    	bcf INTCON,T0IF ;Limpiar el indicador de desborde
0475    012C    151F    	bsf ADCON0,GO ;Comenzar conversion A/D
0476    012D            _espera:
0477    012D    191F    	btfsc ADCON0,GO ;ADCON0 es 0? (la conversion esta completa?)
0478    012E    292D    	goto _espera ;No, ir _espera
0479    012F    081E    	movf ADRESH,W ;Si, W=ADRESH
0480    0130            	; 1Eh ADRESH A/D Result Register High Byte
0481    0130            	; 9Eh ADRESL A/D Result Register Low Byte 
0482    0130    00B8    	movwf ADC ;ADC=W
0483    0131    0838    	movfw ADC ;W = ADC
0484    0132    2936        	goto  V1
0485    0133            returnExec:
0486    0133    083D        MOVFW  	waffles ;DATO of Photocell
0487    0134    00AB        MOVWF 	TMPCELL
0488    0135    2870    	goto COMPARE
0489    0136            
0490    0136            V1:
0491    0136    30D2        movlw D'210'
0492    0137    0238        subwf ADC, W
0493    0138    1C03        btfss STATUS, C
0494    0139    293E        goto V2
0495    013A    3000        movlw 0x0
0496    013B    00BD        movwf waffles
0497    013C    2193        call case0
0498    013D    2933        goto returnExec
0499    013E            
0500    013E            V2:
0501    013E    30C2        movlw D'194'
0502    013F    0238        subwf ADC, W
0503    0140    1C03        btfss STATUS, C
0504    0141    2946        goto V3
0505    0142    3001        movlw 0x1
0506    0143    00BD        movwf waffles
0507    0144    219B        call case1
0508    0145    2933        goto returnExec
0509    0146            
0510    0146            V3:
0511    0146    30AE        movlw D'174'
0512    0147    0238        subwf ADC, W
0513    0148    1C03        btfss STATUS, C
0514    0149    294E        goto V4
0515    014A    3002        movlw 0x2
0516    014B    00BD        movwf waffles
0517    014C    21A3        call case2
0518    014D    2933        goto returnExec
0519    014E            
0520    014E            V4:
0521    014E    309E        movlw D'158'
0522    014F    0238        subwf ADC, W
0523    0150    1C03        btfss STATUS, C
0524    0151    2956        goto V5
0525    0152    3003        movlw 0x3
0526    0153    00BD        movwf waffles
0527    0154    21AB        call case3
0528    0155    2933        goto returnExec
0529    0156            
0530    0156            V5:
0531    0156    308A        movlw D'138'
0532    0157    0238        subwf ADC, W
0533    0158    1C03        btfss STATUS, C
0534    0159    295E        goto V6
0535    015A    3004        movlw 0x4
0536    015B    00BD        movwf waffles
0537    015C    21B3        call case4
0538    015D    2933        goto returnExec
0539    015E            
0540    015E            V6:
0541    015E    3075        movlw D'117'
0542    015F    0238        subwf ADC, W
0543    0160    1C03        btfss STATUS, C
0544    0161    2966        goto V7
0545    0162    3005        movlw 0x5
0546    0163    00BD        movwf waffles
0547    0164    21BB        call case5
0548    0165    2933        goto returnExec
0549    0166            
0550    0166            V7:
0551    0166    3052        movlw D'82'
0552    0167    0238        subwf ADC, W
0553    0168    1C03        btfss STATUS, C
0554    0169    296E        goto V8
0555    016A    3006        movlw 0x6
0556    016B    00BD        movwf waffles
0557    016C    21C3        call case6
0558    016D    2933        goto returnExec
0559    016E            
0560    016E            V8:
0561    016E    3033        movlw D'51'
0562    016F    0238        subwf ADC, W
0563    0170    1C03        btfss STATUS, C
0564    0171    2976        goto V9
0565    0172    3007        movlw 0x7
0566    0173    00BD        movwf waffles
0567    0174    21CB        call case7
0568    0175    2933        goto returnExec
0569    0176            
0570    0176            V9:
0571    0176    301C        movlw D'28'
0572    0177    0238        subwf ADC, W
0573    0178    1C03        btfss STATUS, C
0574    0179    297E        goto V10
0575    017A    3008        movlw 0x8
0576    017B    00BD        movwf waffles
0577    017C    21D3        call case8
0578    017D    2933        goto returnExec
0579    017E            
0580    017E            V10:
0581    017E                ; movlw D'0'
0582    017E                ; subwf ADC, W
0583    017E                ; btfss STATUS, N
0584    017E                ; goto V10<--
0585    017E                ;btfsc STATUS, C
0586    017E    3009        movlw 0x9
0587    017F    00BD        movwf waffles
0588    0180    21DB        call case9
0589    0181    2933        goto returnExec
0590    0182            
0591    0182            _PRESPERA:
0592    0182    30FF    	MOVLW 0XFF
0593    0183    00C0    	MOVWF CounterA
0594    0184    00BF    	MOVWF COUNTERb
0595    0185    00BE    	MOVWF COUNTERc	
0596    0186    2188    	CALL ESPE
0597    0187    0008    	RETURN	
0598    0188            	
0599    0188            ESPE:
0600    0188    0BC0    	DECFSZ	CounterA,0X01
0601    0189    2988    	GOTO	ESPE
0602    018A    218C    	CALL	ESPE2
0603    018B    0008    	RETURN
0604    018C            ESPE2:
0605    018C    0BBF    	DECFSZ	COUNTERb,0X01
0606    018D    298C    	GOTO	ESPE2
0607    018E    2190    	CALL	ESPE3
0608    018F    0008    	RETURN
0609    0190            ESPE3:
0610    0190    0BBE    	DECFSZ	COUNTERc,0X01
0611    0191    2990    	GOTO	ESPE3
0612    0192    0008    	RETURN	
0613    0193            
0614    0193            case0
0615    0193    1485        bsf PORTA, 1
0616    0194    1505        bsf PORTA, 2
0617    0195    1585        bsf PORTA, 3
0618    0196    1605        bsf PORTA, 4
0619    0197    1685        bsf PORTA, 5
0620    0198    1409        bsf PORTE, 0
0621    0199    1089        bcf PORTE, 1
0622    019A    0008        return 
0623    019B            case1
0624    019B                ;movlw 0x0
0625    019B    1085        bcf PORTA, 1
0626    019C    1205        bcf PORTA, 4
0627    019D    1285        bcf PORTA, 5
0628    019E    1009        bcf PORTE, 0
0629    019F    1089        bcf PORTE, 1
0630    01A0                ;movlw 0x1
0631    01A0    1505        bsf PORTA, 2
0632    01A1    1585        bsf PORTA, 3
0633    01A2    0008        return
0634    01A3            case2
0635    01A3                ;movlw 0x1
0636    01A3    1485        bsf PORTA, 1
0637    01A4    1505        bsf PORTA, 2
0638    01A5    1605        bsf PORTA, 4
0639    01A6    1685        bsf PORTA, 5
0640    01A7    1489        bsf PORTE, 1
0641    01A8                ;movlw 0x0
0642    01A8    1185        bcf PORTA, 3
0643    01A9    1009        bcf PORTE, 0
0644    01AA    0008        return
0645    01AB            case3
0646    01AB                ;movlw 0x1
0647    01AB    1485        bsf PORTA, 1
0648    01AC    1505        bsf PORTA, 2
0649    01AD    1585        bsf PORTA, 3
0650    01AE    1605        bsf PORTA, 4
0651    01AF    1489        bsf PORTE, 1
0652    01B0                ;movlw 0x0
0653    01B0    1009        bcf PORTE, 0
0654    01B1    1285        bcf PORTA, 5
0655    01B2    0008        return
0656    01B3            case4
0657    01B3                ;movlw 0x1
0658    01B3    1505        bsf PORTA, 2
0659    01B4    1585        bsf PORTA, 3
0660    01B5    1409        bsf PORTE, 0
0661    01B6    1489        bsf PORTE, 1
0662    01B7                ;movlw 0x0
0663    01B7    1085        bcf PORTA, 1
0664    01B8    1205        bcf PORTA, 4
0665    01B9    1285        bcf PORTA, 5
0666    01BA    0008        return
0667    01BB            case5
0668    01BB                ;movlw 0x1
0669    01BB    1585        bsf PORTA, 3
0670    01BC    1605        bsf PORTA, 4
0671    01BD    1409        bsf PORTE, 0
0672    01BE    1489        bsf PORTE, 1
0673    01BF    1485        bsf PORTA, 1
0674    01C0                ;movlw 0x0
0675    01C0    1285        bcf PORTA, 5
0676    01C1    1105        bcf PORTA, 2
0677    01C2    0008        return
0678    01C3            case6
0679    01C3                ;movlw 0x1
0680    01C3    1585        bsf PORTA, 3
0681    01C4    1605        bsf PORTA, 4
0682    01C5    1685        bsf PORTA, 5
0683    01C6    1409        bsf PORTE, 0
0684    01C7    1489        bsf PORTE, 1
0685    01C8    1485        bsf PORTA, 1
0686    01C9                ;movlw 0x0
0687    01C9    1105        bcf PORTA, 2
0688    01CA    0008        return
0689    01CB            case7
0690    01CB                ;movlw 0x1
0691    01CB    1485        bsf PORTA, 1
0692    01CC    1505        bsf PORTA, 2
0693    01CD    1585        bsf PORTA, 3
0694    01CE                ;movlw 0x0
0695    01CE    1205        bcf PORTA, 4
0696    01CF    1285        bcf PORTA, 5
0697    01D0    1009        bcf PORTE, 0
0698    01D1    1089        bcf PORTE, 1
0699    01D2    0008        return
0700    01D3            case8
0701    01D3                ;movlw 0x1
0702    01D3    1485        bsf PORTA, 1
0703    01D4    1505        bsf PORTA, 2
0704    01D5    1585        bsf PORTA, 3
0705    01D6    1605        bsf PORTA, 4
0706    01D7    1685        bsf PORTA, 5
0707    01D8    1409        bsf PORTE, 0
0708    01D9    1489        bsf PORTE, 1
0709    01DA    0008        return
0710    01DB            case9
0711    01DB                ;movlw 0x1
0712    01DB    1485        bsf PORTA, 1
0713    01DC    1505        bsf PORTA, 2
0714    01DD    1585        bsf PORTA, 3
0715    01DE    1605        bsf PORTA, 4
0716    01DF    1409        bsf PORTE, 0
0717    01E0    1489        bsf PORTE, 1
0718    01E1                ;movlw 0x0
0719    01E1    1285        bcf PORTA, 5
0720    01E2    0008        return
0721    01E3            
0722    01E3            END
---------------------------------------------
Number of errors = 0
